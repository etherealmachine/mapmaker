{"version":3,"sources":["webpack:///./src/design_system-DS.astroturf.css?0131","design_system-DS.astroturf.css","webpack:///./src/Zoom-classes.astroturf.css?92e9","Zoom-classes.astroturf.css","webpack:///./src/Description-classes.astroturf.css?6438","Description-classes.astroturf.css","webpack:///./src/DescriptionEditor-classes.astroturf.css?05e7","DescriptionEditor-classes.astroturf.css","webpack:///./src/LevelEditor-classes.astroturf.css?fe66","LevelEditor-classes.astroturf.css","webpack:///./src/Drawer-classes.astroturf.css?1680","Drawer-classes.astroturf.css","webpack:///./src/LevelSelector-classes.astroturf.css?fc5f","LevelSelector-classes.astroturf.css","webpack:///./src/Modal-classes.astroturf.css?f264","Modal-classes.astroturf.css","webpack:///./src/Menubar-classes.astroturf.css?513a","Menubar-classes.astroturf.css","webpack:///./src/HomeButton-classes.astroturf.css?e2cc","HomeButton-classes.astroturf.css","webpack:///./src/PrintLayout-classes.astroturf.css?93af","PrintLayout-classes.astroturf.css","webpack:///./src/Welcome-classes.astroturf.css?00ab","Welcome-classes.astroturf.css","webpack:///./src/Tooltip-classes.astroturf.css?c0b5","Tooltip-classes.astroturf.css","webpack:///./src/Toggle-classes.astroturf.css?e555","Toggle-classes.astroturf.css","webpack:///./src/App-classes.astroturf.css?879d","App-classes.astroturf.css","lib.ts","State.ts","design_system.tsx","Zoom.tsx","Canvas.tsx","Description.tsx","DescriptionEditor.tsx","FeatureEditor.tsx","LevelEditor.tsx","MapEditor.tsx","Drawer.tsx","LevelSelector.tsx","Modal.tsx","Menubar.tsx","HomeButton.tsx","PrintLayout.tsx","icons/custom_icons.ts","Welcome.tsx","Tooltip.tsx","Toggle.tsx","Toolbar.tsx","Persistence.ts","App.tsx","index.tsx"],"names":["content","module","i","options","transform","undefined","locals","exports","___CSS_LOADER_API_IMPORT___","push","dist","a","b","Math","sqrt","sqDist","lerp","d","from","to","lerp2","clamp","p","min","max","indexToColor","j","Error","bbox","points","minX","map","maxX","minY","maxY","sw","ne","w","h","isCCW","ring","signedArea","slice","length","forEach","point","x2","y2","toPolyBoolPoly","geoms","regions","geom","coordinates","inverted","closestPointToLine","ap","ab","distance","closestPointToPolygon","polygon","line","sort","detectDoorPlacement","features","fullWidth","closestFeature","flatMap","feature","geometries","geometry","type","closestPoint","Infinity","f","includes","coords","center","slope","vdy1","floor","vdx1","vdy2","ceil","vdx2","hdx1","hdy1","hdx2","hdy2","vfrom","vto","vdist","hfrom","hto","hdist","isNaN","computeDoorPlacement","find","ellipse","brush","twicearea","x","y","p1","p2","centroid","round","undoStack","redoStack","modify","state","propertyKey","descriptor","modifierFn","value","args","Array","arguments","this","setState","produce","newState","prev","JSON","stringify","maps","selection","mapIndex","bind","curr","undoable","splice","hasOwnProperty","notifyChange","State","tools","selected","group","disabled","subtype","scale","offset","TempleOfClangeddin","drawerOpen","drawerWidth","levelIndex","featureIndex","geometryIndex","ghostLevels","gridSteps","debug","showWelcome","levels","url","encodeURIComponent","document","createElement","setAttribute","name","body","appendChild","click","remove","mapName","description","pop","parse","stairs","properties","decoration","rect","walls","deltaDrag","reverse","door","doors","selectedFeature","geom1","geom2","mergedGeoms","merged","PolyBool","region","merge","filter","prevGeoms","concat","tool","Object","values","t","option","open","width","desc","level","assign","sourceIndex","destIndex","removed","Context","React","createContext","specialColors","CanvasRenderer","canvas","mode","mouse","mouseDown","drag","specialKeys","shift","alt","ctrl","space","polygonToolSelected","hover","size","fps","requestID","appState","ctx","bufferCanvas","bufferCtx","textures","dirty","Date","onMouseDown","e","MouseEvent","button","start","canvasToTile","end","pointer","selectedFeatureIndex","hoverFeatureIndex","hoverGeometryIndex","shiftKey","handleGroup","setSelection","worldToTile","canvasToWorld","addDoor","onMouseUp","pos","handlePolygon","handleBrush","bounds","handleDrag","onMouseMove","event","target","getBoundingClientRect","touches","clientX","left","clientY","top","offsetX","offsetY","delta","newOffset","window","requestAnimationFrame","setOffset","onWheel","elementFromPoint","stopPropagation","preventDefault","deltaX","deltaY","onKeyDown","key","activeElement","handleDelete","undo","redo","style","cursor","onKeyUp","worldToCanvas","S","render","time","getTime","startTime","performance","now","resetTransform","clearScreen","currLevel","drawLevel","globalAlpha","entries","parseInt","save","translate","drawMousePos","drawPolygon","drawBrush","drawDrag","restore","renderFPS","getContext","alpha","height","addEventListener","passive","removeEventListener","filenames","buf","bufCtx","filename","img","onload","drawImage","pattern","createPattern","matrix","DOMMatrix","setTransform","src","process","text","font","m","measureText","actualBoundingBoxAscent","actualBoundingBoxDescent","fillText","toFixed","fillStyle","renderTextCenter","fillRect","clearRect","iT","getTransform","inverse","transformPoint","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","arc","PI","fill","drawGeometry","drawStairs","drawDecoration","box","drawEllipse","drawLine","indexColor","drawDoor","pathPoints","CanvasGradient","CanvasPattern","drawPoints","pathEllipse","lineJoin","lineCap","globalCompositeOperation","drawNormalDoor","drawSecretDoor","l","abs","cx","actualBoundingBoxLeft","actualBoundingBoxRight","cy","sx","sign","sy","L","W","closePath","drawStatue","drawColumn","drawStalacmite","r","r2","theta","cos","sin","rng","seedrandom","currRadius","close","colorIndex","featureDrawOrder","geometryDrawOrder","featureType","geometryType","areaColor","c","selectable","g","tmp","drawFeatures","getImageData","data","range","reduce","extent","levelMid","zoomToCenter","getSelectedFeature","drawGrid","Canvas","props","canvasRef","useRef","useContext","useState","renderer","setRenderer","useEffect","current","syncSize","parentElement","offsetWidth","offsetHeight","attachListeners","detachListeners","ref","Zoom","FeatureEditor","lastSelection","setLastSelection","tmpName","setTmpName","tmpDescription","setTmpDescription","color","DescriptionEditor","onNameChange","onDescriptionChange","onSave","setFeatureDescription","onUndo","onDelete","MapEditor","setMapDescription","MapSelector","statueIcon","prefix","iconName","icon","buttons","faMousePointer","tooltip","faSquare","faDoorClosed","faStrikethrough","faBrush","faVectorSquare","faDrawPolygon","faCircle","Toolbar","isOptionSelected","handleOptionClick","setToolOption","iconFor","faExclamationTriangle","className","DS","toolbar","position","spec","Tooltip","Fragment","onClick","setSelectedTool","optionName","optionSpec","Toggle","toggled","onToggle","setGridSteps","isObject","isArray","unfreeze","o","oo","v","String","property","useLocalStorageState","initial","fromLocalStorage","localStorage","getItem","inflate","objs","obj","isFrozen","setItem","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","ReactDOM","StrictMode","App","getElementById"],"mappings":"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AAgB,OA0BhB,SAAS0R,GAAYlC,GACrB,+BACA,oCACA,oCACA,6BACA,iEACA,wBACA,qBACA,0CACA,cAOA,cACA,+BACA,gBAFA,EAGA,2BAHA,mBAGA,EAHA,KAGA,EAHA,KAOA,iDAPA,EAQA,uBARA,mBAQA,EARA,KAQA,EARA,OAmBA,gCAnBA,mBAmBA,EAnBA,KAmBA,EAnBA,KAwBA,OAJA,uEACA,eACA,WAEA,oCACA,+CACA,wDACA,+DAvBA,YACA,qBAuBA,4BACA,yBACA,mCAFA,QAKA,6CACA,yBACA,2BAFA,QAKA,4BACA,yBACA,gCAFA,OAKA,4BACA,yBACA,8BAFA,QAKA,4BACA,yBACA,8BAFA,QAKA,4BACA,yBACA,sCAFA,SAKA,4BACA,yBACA,uCAFA,QAKA,sCACA,4BACA,yBACA,gCAFA,UAKA,4BACA,yBACA,+BAFA,UAMA,iDACA,wCACA,2BACA,gBACA,gBACA,8DAGA,iEACA,+BA3EA,YACA,gBACA,WACA,aACA,oBACA,qBACA,iBAEA,WC1DA,OAAgB,OA8BhB,cACA,+BACA,mDACA,iHClCA,OAAgB,OA+BhB,cACA,+BACA,+BACA,KAOA,OANA,gCACA,kCACA,GADA,IAEA,0EAGA,6CACA,4CACA,oCACA,yGACA,6CACA,+CAGA,6CACA,4DACA,+CACA,8CAEA,oCACA,yGACA,qEACA,0FACA,8HC5DO,IAwBMmC,GAA0C,CACrDC,OAAQ,MACRC,SAAU,SACVC,KAAM,CACJ,IACA,IACA,GACA,OACA,0mBChCJ,GAAgB,OAkBhB,cACA,0DACA,8DACA,2CACA,4BACA,mFACA,6GACA,oHACA,8IACA,yIACA,0EAEA,uCACA,4BACA,gJACA,0LAEA,uK,cCrCA,GAAgB,OAShB,eACA,6BACA,yBACA,yBAHA,EAIA,uBAJA,mBAIA,EAJA,KAIA,EAJA,KAKA,aACA,OAEA,aACA,OAqBA,OAnBA,gCACA,sBACA,kCACA,kBACA,WACA,CACA,cACA,SACA,mBAMA,YACA,2CACA,8CAEA,OACA,gCACA,0BACA,MACA,iCACA,sBACA,WAEA,gCACA,aChDA,OAAgB,OAu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","file":"static/js/main.bff26fb8.chunk.js","sourcesContent":["\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./design_system-DS.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./design_system-DS.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./design_system-DS.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1T682EN3wGuui_M4H8-h4d {\\n    background: transparent;\\n    border: none;\\n    outline: none;\\n    margin: 4px;\\n    padding: 8px 12px;\\n    color: white;\\n    font-size: 18px;\\n    font-weight: 600;\\n    box-sizing: border-box;\\n    border-radius: 2px;\\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\\n  }\\n\\n  ._1T682EN3wGuui_M4H8-h4d:hover {\\n    background: #505050;\\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\\n  }\\n\\n  ._1T682EN3wGuui_M4H8-h4d:active {\\n    outline: none;\\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\\n  }\\n\\n  ._3y7SXyz4JOCnc5uHwMgV6G {\\n    background: transparent;\\n    border: none;\\n    outline: none;\\n    margin: 4px;\\n    color: white;\\n    font-size: 18px;\\n    font-weight: 600;\\n    box-sizing: border-box;\\n    border-radius: 2px;\\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\\n  }\\n\\n  ._3y7SXyz4JOCnc5uHwMgV6G:hover {\\n    background: #505050;\\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\\n  }\\n\\n  ._3y7SXyz4JOCnc5uHwMgV6G:active {\\n    outline: none;\\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\\n  }\\n\\n  ._23Y2hTXZx4yRztG6Og2hsX {\\n    background: #A20B25;\\n  }\\n\\n  ._23Y2hTXZx4yRztG6Og2hsX:hover {\\n    background: #a03e4e;\\n  }\\n\\n  ._3TM3EDP4hscy9_4eMYFQ4j {\\n    font-size: 18px;\\n    background: transparent;\\n    color: white;\\n    border: none;\\n    border-bottom: 1px solid white;\\n    padding: 4px;\\n    margin: 4px;\\n    margin-bottom: 1px;\\n  }\\n  \\n  ._3TM3EDP4hscy9_4eMYFQ4j:focus {\\n    outline: none;\\n    border-bottom: 2px solid white;\\n    margin-bottom: 0px;\\n  }\\n\\n  ._1QialzHq4mUm3mfxM9dFjo {\\n    display: flex;\\n    flex-direction: column;\\n    background: #000;\\n    border-radius: 12px;\\n    padding: 8px;\\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\\n    color: white;\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo svg {\\n    color: white;\\n    font-size: 24px;\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo .y38q2UbGKcnf8XF1TwQCQ svg {\\n    color: black;\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo button {\\n    background: black;\\n    width: 50px;\\n    height: 50px;\\n    border: 1px solid white;\\n    outline: none;\\n    margin: 4px;\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo button:hover {\\n    background: #505050;\\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo button:active {\\n    outline: none;\\n    border: none;\\n    scale: 0.9;\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo button.y38q2UbGKcnf8XF1TwQCQ {\\n    background: #bbb;\\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\\n  }\\n  ._1QialzHq4mUm3mfxM9dFjo button[disabled] {\\n    background: #444;\\n    box-shadow: none;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"button\": \"_1T682EN3wGuui_M4H8-h4d\",\n\t\"buttonSmall\": \"_3y7SXyz4JOCnc5uHwMgV6G\",\n\t\"danger\": \"_23Y2hTXZx4yRztG6Og2hsX\",\n\t\"input\": \"_3TM3EDP4hscy9_4eMYFQ4j\",\n\t\"toolbar\": \"_1QialzHq4mUm3mfxM9dFjo\",\n\t\"selected\": \"y38q2UbGKcnf8XF1TwQCQ\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Zoom-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Zoom-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Zoom-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1UqzVcjxvXSzZbvZKvXYKi button {\\n    background: black;\\n    width: 24px;\\n    height: 24px;\\n    border: 1px solid white;\\n    outline: none;\\n    margin: 4px;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    color: white;\\n  }\\n  ._1UqzVcjxvXSzZbvZKvXYKi svg {\\n    color: white;\\n    font-size: 12px;\\n  }\\n  ._1UqzVcjxvXSzZbvZKvXYKi button:hover {\\n    background: #505050;\\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\\n  }\\n  ._1UqzVcjxvXSzZbvZKvXYKi button:active {\\n    outline: none;\\n    border: none;\\n    scale: 0.9;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"zoom\": \"_1UqzVcjxvXSzZbvZKvXYKi\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Description-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Description-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Description-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._3IlFEbyxwjKJ9Sy-1JAUwL {\\n    margin: 0;\\n    padding: 0 8px;\\n    color: white;\\n  }\\n  ._3IlFEbyxwjKJ9Sy-1JAUwL h1 {\\n    font-size: 24px;\\n    font-family: Helvetica serif;\\n    padding: 0 8px;\\n    margin: 0;\\n    color: white;\\n  }\\n  ._3IlFEbyxwjKJ9Sy-1JAUwL p {\\n    font-size: 18px;\\n    font-family: Helvetica serif;\\n    padding: 0;\\n    margin: 0;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"formattedText\": \"_3IlFEbyxwjKJ9Sy-1JAUwL\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./DescriptionEditor-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./DescriptionEditor-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./DescriptionEditor-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._3W5IvxPia75NSEZmFXoBmA {\\n    display: flex;\\n    flex-direction: column;\\n  }\\n  ._3W5IvxPia75NSEZmFXoBmA textarea {\\n    height: 400px;\\n    outline: none;\\n    border: none;\\n  }\\n  ._3N02lA9zkh_pv4M7FdSKFQ {\\n    font-family: Helvetica serif;\\n    font-size: 24px;\\n    color: white;\\n    padding: 8px;\\n  }\\n  ._1QtaoYNAGXwdUqEuaQejp4 {\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: flex-start;\\n    margin: 12px 24px;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"editor\": \"_3W5IvxPia75NSEZmFXoBmA\",\n\t\"name\": \"_3N02lA9zkh_pv4M7FdSKFQ\",\n\t\"actions\": \"_1QtaoYNAGXwdUqEuaQejp4\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./LevelEditor-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./LevelEditor-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./LevelEditor-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._3ZJnUkz9JITQGyOviOpcbX {\\n    font-family: Helvetica serif;\\n    font-size: 18px;\\n    color: white;\\n    padding: 8px;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"features\": \"_3ZJnUkz9JITQGyOviOpcbX\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Drawer-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Drawer-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Drawer-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._7wQ_KhraOD7XNV_7Gcnj4 {\\n    width: 0;\\n    margin: 8px 0;\\n    position: absolute;\\n    right: 0;\\n    top: 0;\\n    bottom: 0;\\n    background: #373737;\\n    box-sizing: border-box;\\n    transition: .2s ease-out;\\n  }\\n    ._7wQ_KhraOD7XNV_7Gcnj4._1MlyHLj10SQkIHXsiINIx1 {\\n      transition: .2s ease-out;\\n      z-index: 100;\\n    }\\n  ._2I5tLfqZmuI4hmhaiAXBzH {\\n    position: absolute;\\n    top: 0;\\n    left: -27px;\\n    background: #373737;\\n    color: white;\\n    outline: none;\\n    border: none;\\n    font-size: 30px;\\n    padding: 8px;\\n    border-radius: 4px 0 0 4px;\\n  }\\n  .NsuFqULDSfAB5HIY7HbUg {\\n    height: 97%;\\n    overflow: scroll;\\n    padding: 8px;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"drawer\": \"_7wQ_KhraOD7XNV_7Gcnj4\",\n\t\"open\": \"_1MlyHLj10SQkIHXsiINIx1\",\n\t\"toggleButton\": \"_2I5tLfqZmuI4hmhaiAXBzH\",\n\t\"editors\": \"NsuFqULDSfAB5HIY7HbUg\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./LevelSelector-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./LevelSelector-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./LevelSelector-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._38X7Ih6LgSulEuEtueMD2U {\\n    display: flex;\\n    flex-direction: column;\\n    position: absolute;\\n    bottom: 0;\\n    left: 0;\\n    background: #000;\\n    border-radius: 12px;\\n    margin-bottom: 50px;\\n    margin-left: 24px;\\n    padding: 8px;\\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\\n    color: white;\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U svg {\\n    color: white;\\n    font-size: 12px;\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U button {\\n    background: black;\\n    width: 24px;\\n    height: 24px;\\n    border: 1px solid white;\\n    outline: none;\\n    margin: 4px;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    color: white;\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U button:hover {\\n    background: #505050;\\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U button:active {\\n    outline: none;\\n    border: none;\\n    scale: 0.9;\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U button.X3vmDKNXaSrZpzJYj5SqK {\\n    color: black;\\n    background: #bbb;\\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\\n  }\\n  ._38X7Ih6LgSulEuEtueMD2U h4 {\\n    margin: 0;\\n    padding: 0;\\n  }\\n  ._32AnUS1IZ28UbU4adMP6GT {\\n    display: flex;\\n    align-items: center;\\n  }\\n  button._2XSEgiWqLvufrbRqULO4Ng {\\n    outline: none;\\n    border: none;\\n  }\\n  ._2XSEgiWqLvufrbRqULO4Ng:hover {\\n    cursor: pointer;\\n    text-decoration: underline;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"levels\": \"_38X7Ih6LgSulEuEtueMD2U\",\n\t\"selected\": \"X3vmDKNXaSrZpzJYj5SqK\",\n\t\"level\": \"_32AnUS1IZ28UbU4adMP6GT\",\n\t\"link\": \"_2XSEgiWqLvufrbRqULO4Ng\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Modal-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Modal-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Modal-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1429OEOGcRhOAV0J3Gg-KT {\\n    position: fixed;\\n    z-index: 1000;\\n    left: 0;\\n    top: 0;\\n    width: 100%;\\n    height: 100%;\\n    overflow: auto;\\n    background-color: rgba(0, 0, 0, 0.4);\\n  }\\n\\n  ._1DN0JTMd6pHMuwsTOAvt2j {\\n    position: relative;\\n    background-color: #373737;\\n    color: #fff;\\n    margin: 64px auto;\\n    padding: 0 20px 20px 20px;\\n    border: 1px solid #888;\\n    border-radius: 8px;\\n    width: 60%;\\n  }\\n\\n  ._1DN0JTMd6pHMuwsTOAvt2j button {\\n    outline: none;\\n    border: none;\\n    background-color: transparent;\\n    color: #fff;\\n    font-size: 24px;\\n    position: absolute;\\n    top: 8px;\\n    right: 8px;\\n    text-decoration: none;\\n    cursor: pointer;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"modal\": \"_1429OEOGcRhOAV0J3Gg-KT\",\n\t\"modalContent\": \"_1DN0JTMd6pHMuwsTOAvt2j\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Menubar-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Menubar-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Menubar-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._2aM8m-4Xx92dNWnaEGRNME {\\n    display: flex;\\n    flex-direction: row;\\n    align-items: center;\\n    background: #373737;\\n    padding: 2px;\\n    width: 100%;\\n  }\\n  ._3HEPmFe0KP_qc9LRO7uwIh {\\n    color: white;\\n    margin: 8px 24px 8px 24px;\\n  }\\n  .yr0iF51zaJ_HOYfzQrmAp {\\n    margin-left: auto;\\n    margin-right: 24px;\\n  }\\n  label {\\n    color: white;\\n  }\\n  ._2HSpHXCXB2uWq9tBHwycOe:hover {\\n    text-decoration: underline;\\n    cursor: pointer;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"menubar\": \"_2aM8m-4Xx92dNWnaEGRNME\",\n\t\"title\": \"_3HEPmFe0KP_qc9LRO7uwIh\",\n\t\"debugMenu\": \"yr0iF51zaJ_HOYfzQrmAp\",\n\t\"mapLink\": \"_2HSpHXCXB2uWq9tBHwycOe\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./HomeButton-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./HomeButton-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./HomeButton-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1bKtBCtBoCYJg7vkFGtY1S {\\n    display: flex;\\n    flex-direction: column;\\n    position: absolute;\\n    bottom: 0;\\n    right: 0;\\n    padding: 8px;\\n    z-index: 1;\\n  }\\n  ._1bKtBCtBoCYJg7vkFGtY1S svg {\\n    color: #505050;\\n    font-size: 24px;\\n  }\\n  ._1bKtBCtBoCYJg7vkFGtY1S button {\\n    background: transparent;\\n    outline: none;\\n    border: none; \\n    display: flex;\\n    margin: 2px;\\n    align-items: center;\\n    justify-content: center;\\n    width: 24px;\\n    height: 24px;\\n  }\\n  ._1bKtBCtBoCYJg7vkFGtY1S button:hover svg {\\n    color: #000;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"home\": \"_1bKtBCtBoCYJg7vkFGtY1S\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./PrintLayout-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./PrintLayout-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./PrintLayout-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._2LtiBs0QFy0T6xn0SS2W3x {\\n    display: flex;\\n    flex-direction: column;\\n    font-family: Helvetica serif;\\n  }\\n  ._6Z9YH7Qxp_AWrunyTXjc7 {\\n    width: 8in;\\n    height: 10.5in;\\n    display: flex;\\n    flex-direction: column;\\n    margin-left: auto;\\n    margin-right: auto;\\n    border-bottom: 1px solid black;\\n    padding: 0.25in;\\n  }\\n  @media print {\\n    ._6Z9YH7Qxp_AWrunyTXjc7 {\\n      border-bottom: none !important;\\n    }\\n  }\\n  ._16g_MaPE_LtUpqw4wDWuQu {\\n    width: 8in;\\n    display: flex;\\n    flex-direction: column;\\n    margin-left: auto;\\n    margin-right: auto;\\n    padding: 0.25in;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"print\": \"_2LtiBs0QFy0T6xn0SS2W3x\",\n\t\"page\": \"_6Z9YH7Qxp_AWrunyTXjc7\",\n\t\"pages\": \"_16g_MaPE_LtUpqw4wDWuQu\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Welcome-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Welcome-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Welcome-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._32RqLWb9TAlxHXLXW5Y7tH {\\n    display: flex;\\n    flex-direction: column;\\n  }\\n  ._32RqLWb9TAlxHXLXW5Y7tH a {\\n    color: white;\\n  }\\n  ._32RqLWb9TAlxHXLXW5Y7tH li {\\n    padding: 4px;\\n  }\\n  ._21_Zg-ByTQDDzrT0uY_Ufj {\\n    font-size: 16px;\\n    margin-left: auto;\\n    margin-right: auto;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"welcomePage\": \"_32RqLWb9TAlxHXLXW5Y7tH\",\n\t\"footer\": \"_21_Zg-ByTQDDzrT0uY_Ufj\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Tooltip-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Tooltip-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Tooltip-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._28mF98z4gM6RA9OdY-YuEy {\\n    color: white;\\n    background: black;\\n    border-radius: 4px;\\n    padding: 8px;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"tooltip\": \"_28mF98z4gM6RA9OdY-YuEy\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./Toggle-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./Toggle-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./Toggle-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1v-ohDNr7AFbOSKLT0CYxX {\\n    position: relative;\\n    display: inline-block;\\n    width: 100%;\\n    height: 34px;\\n  }\\n\\n  ._1v-ohDNr7AFbOSKLT0CYxX input {\\n    opacity: 0;\\n    width: 0;\\n    height: 0;\\n  }\\n\\n  ._2w1KenDtBt0Wyo3aJE-FRz {\\n    position: absolute;\\n    cursor: pointer;\\n    top: 0;\\n    left: 0;\\n    right: 0;\\n    bottom: 0;\\n    background-color: #ccc;\\n    -webkit-transition: .4s;\\n    transition: .4s;\\n    border-radius: 34px;\\n  }\\n\\n  ._2w1KenDtBt0Wyo3aJE-FRz:before {\\n    position: absolute;\\n    content: \\\"\\\";\\n    height: 26px;\\n    width: 26px;\\n    left: 4px;\\n    bottom: 4px;\\n    background-color: white;\\n    -webkit-transition: .4s;\\n    transition: .4s;\\n    border-radius: 50%;\\n  }\\n\\n  ._1v-ohDNr7AFbOSKLT0CYxX input:checked + ._2w1KenDtBt0Wyo3aJE-FRz {\\n    background-color: #2196F3;\\n  }\\n\\n  ._1v-ohDNr7AFbOSKLT0CYxX input:focus + ._2w1KenDtBt0Wyo3aJE-FRz {\\n    box-shadow: 0 0 1px #2196F3;\\n  }\\n\\n  ._1v-ohDNr7AFbOSKLT0CYxX input:checked + ._2w1KenDtBt0Wyo3aJE-FRz:before {\\n    -webkit-transform: translateX(26px);\\n    -ms-transform: translateX(26px);\\n    transform: translateX(26px);\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"toggle\": \"_1v-ohDNr7AFbOSKLT0CYxX\",\n\t\"slider\": \"_2w1KenDtBt0Wyo3aJE-FRz\"\n};\nmodule.exports = exports;\n","\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./App-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./App-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./App-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._1K0xKFlE3XhuIq8I1FpjrW {\\n    width: 100vw;\\n    height: 100vh;\\n    position: relative;\\n    display: flex;\\n    flex-direction: column;\\n  }\\n  ._21qBYvi1wyLFQ2lvKpGD4N {\\n    width: 100%;\\n    height: 100%;\\n    position: relative;\\n    display: flex;\\n    flex-direction: column;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"app\": \"_1K0xKFlE3XhuIq8I1FpjrW\",\n\t\"canvasWrapper\": \"_21qBYvi1wyLFQ2lvKpGD4N\"\n};\nmodule.exports = exports;\n","import * as PolyBool from 'polybooljs';\n\nimport { Feature, Geometry } from './State';\n\nexport function line(x0: number, y0: number, x1: number, y1: number): { x: number, y: number }[] {\n  const dx = Math.abs(x1 - x0);\n  const dy = Math.abs(y1 - y0);\n  const sx = (x0 < x1) ? 1 : -1;\n  const sy = (y0 < y1) ? 1 : -1;\n  let err = dx - dy;\n  const points = [];\n  while (true) {\n    points.push({ x: x0, y: y0 });\n    if ((x0 === x1) && (y0 === y1)) break;\n    var e2 = 2 * err;\n    if (e2 > -dy) { err -= dy; x0 += sx; }\n    if (e2 < dx) { err += dx; y0 += sy; }\n  }\n  return points;\n}\n\nexport function sqDist(a: number[], b: number[]): number {\n  return (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1]);\n}\n\nexport function dist(a: number[], b: number[]): number {\n  return Math.sqrt(sqDist(a, b));\n}\n\nexport function area(points: number[][]) {\n  let a = 0;\n  for (let i = 0; i < points.length; i++) {\n    const curr = points[i];\n    const next = points[i + 1];\n    a += curr[0] * next[0] - curr[1] * next[1];\n  }\n  return Math.abs(a / 2);\n}\n\nexport function lerp(d: number, from: number, to: number): number {\n  return from + (to - from) * d;\n}\n\nexport function lerp2(d: number, from: number[], to: number[]): number[] {\n  return [lerp(d, from[0], to[0]), lerp(d, from[1], to[1])];\n}\n\nexport function clamp(p: number, min: number, max: number): number {\n  if (p < min) return min;\n  if (p > max) return max;\n  return p;\n}\n\nexport function rgbToHex(r: number, g: number, b: number): string {\n  if (r < 0 || r > 255 || g < 0 || g > 255 || b < 0 || b > 255) throw new Error('Invalid color component');\n  return ((r << 16) | (g << 8) | b).toString(16);\n}\n\nexport function colorToIndex(r: number, g: number, b: number): number[] {\n  return [r, g];\n}\n\nexport function indexToColor(i: number, j: number): string {\n  if (i < 0 || i >= 256) throw new Error('Index out of range');\n  if (j < 0 || j >= 256) throw new Error('Index out of range');\n  return `rgb(${i}, ${j}, 0)`;\n}\n\nexport function bbox(points: number[][]) {\n  const minX = Math.min(...points.map(p => p[0]));\n  const maxX = Math.max(...points.map(p => p[0]));\n  const minY = Math.min(...points.map(p => p[1]));\n  const maxY = Math.max(...points.map(p => p[1]));\n  return {\n    sw: [minX, maxY],\n    ne: [maxX, minY],\n    w: maxX - minX,\n    h: maxY - minY,\n  };\n}\n\nexport function isCCW(ring: number[][]): boolean {\n  let signedArea = 0\n  ring.slice(0, ring.length - 1).forEach((point, i) => {\n    const [x2, y2] = ring[i + 1];\n    signedArea += (point[0] * y2 - x2 * point[1]);\n  });\n  return signedArea < 0;\n}\n\nfunction toPolyBoolPoly(geoms: Geometry[]): PolyBool.Polygon {\n  return {\n    regions: geoms.map(geom => geom.coordinates),\n    inverted: false,\n  };\n}\n\nfunction fromPolyBoolPoly(points: number[][]): Geometry {\n  return {\n    type: 'polygon',\n    coordinates: points,\n  };\n}\n\nexport function merge(geoms: Geometry[], geom: Geometry): Geometry[] {\n  const poly = PolyBool.union(toPolyBoolPoly(geoms), toPolyBoolPoly([geom]));\n  const merged = poly.regions.map(region => fromPolyBoolPoly(region));\n  merged.sort((a, b) => {\n    if (a.type === 'polygon' && b.type !== 'polygon') return -1;\n    if (b.type === 'polygon' && a.type !== 'polygon') return 1;\n    if (a.type !== 'polygon' && b.type !== 'polygon') return 0;\n    if (isCCW(a.coordinates) && isCCW(b.coordinates)) return 0;\n    if (isCCW(a.coordinates) && !isCCW(b.coordinates)) return -1;\n    return 1;\n  });\n  merged.forEach(geom => {\n    if (geom.type === 'polygon' && geom.coordinates[0] !== geom.coordinates[geom.coordinates.length - 1]) {\n      geom.coordinates.push([geom.coordinates[0][0], geom.coordinates[0][1]]);\n    }\n  })\n  return merged;\n}\n\nexport function closestPointToLine(p: number[], a: number[], b: number[]): { point: number[], distance: number } {\n  const ap = [p[0] - a[0], p[1] - a[1]]; // Line segment AP\n  const ab = [b[0] - a[0], b[1] - a[1]]; // Line segment AB\n  const ab2 = ab[0] * ab[0] + ab[1] * ab[1]; // Square magnitude of AB, ||AB||^2\n  const ap_dot_ab = ap[0] * ab[0] + ap[1] * ab[1] // Dot product, APAB\n  const d = clamp(ap_dot_ab / ab2, 0, 1); // Normalized distance from A to closest point\n  const point = [a[0] + ab[0] * d, a[1] + ab[1] * d];\n  return {\n    point: point,\n    distance: dist(point, p),\n  };\n}\n\ninterface ClosestPoint {\n  point: number[]\n  line: number[]\n  distance: number\n}\n\ninterface ClosestFeature {\n  feature: number\n  geometry: number\n  closestPoint: ClosestPoint\n}\n\nexport interface DoorPlacement extends ClosestFeature {\n  from: number[]\n  to: number[]\n}\n\nexport function closestPointToPolygon(point: number[], polygon: number[][]): ClosestPoint {\n  return polygon.map((a: number[], i: number) => {\n    return {\n      ...closestPointToLine(point, a, polygon[(i + 1) % polygon.length]),\n      line: [i, (i + 1) % polygon.length],\n    };\n  }).sort((a, b) => a.distance - b.distance)[0];\n}\n\nexport function detectDoorPlacement(point: number[], features: Feature[], fullWidth: boolean): DoorPlacement | undefined {\n  const closestFeature = features.flatMap((feature, i) => {\n    return feature.geometries.flatMap((geometry, j) => {\n      if (geometry.type === 'polygon') {\n        return {\n          feature: i,\n          geometry: j,\n          closestPoint: closestPointToPolygon(point, geometry.coordinates),\n        };\n      } else if (geometry.type === 'line') {\n        return {\n          feature: i,\n          geometry: j,\n          closestPoint: {\n            ...closestPointToLine(point, geometry.coordinates[0], geometry.coordinates[1]),\n            line: [0, 1],\n          },\n        };\n      }\n      return undefined;\n    });\n  }).sort((a, b) => {\n    if (a === undefined || b === undefined) return Infinity;\n    return a.closestPoint.distance - b.closestPoint.distance;\n  })[0];\n  if (!closestFeature) return undefined;\n  return computeDoorPlacement(closestFeature, features, fullWidth);\n}\n\nfunction computeDoorPlacement(f: ClosestFeature, features: Feature[], fullWidth: boolean): DoorPlacement | undefined {\n  const geom = features[f.feature].geometries[f.geometry];\n  if (!['polygon', 'line'].includes(geom.type)) return undefined;\n  const coords = geom.coordinates;\n  const from = coords[f.closestPoint.line[0]];\n  const to = coords[f.closestPoint.line[1]];\n\n  if (fullWidth) {\n    return { ...f, from: [...from], to: [...to] };\n  }\n\n  const center = f.closestPoint.point;\n  const slope = (to[1] - from[1]) / (to[0] - from[0]);\n\n  const vdy1 = (Math.floor(center[1]) - from[1]);\n  const vdx1 = vdy1 / slope;\n  const vdy2 = (Math.ceil(center[1]) - from[1]);\n  const vdx2 = vdy2 / slope;\n\n  const hdx1 = (Math.floor(center[0]) - from[0]);\n  const hdy1 = hdx1 * slope;\n  const hdx2 = (Math.ceil(center[0]) - from[0]);\n  const hdy2 = hdx2 * slope;\n\n  const vfrom = [from[0] + vdx1, from[1] + vdy1];\n  const vto = [from[0] + vdx2, from[1] + vdy2];\n  const vdist = dist(vfrom, vto);\n\n  const hfrom = [from[0] + hdx1, from[1] + hdy1];\n  const hto = [from[0] + hdx2, from[1] + hdy2];\n  const hdist = dist(hfrom, hto);\n\n  if ((isNaN(hdist) || vdist <= hdist) && vdist > 0) {\n    return {\n      ...f,\n      from: vfrom,\n      to: vto,\n    };\n  } else if ((isNaN(vdist) || hdist < vdist) && hdist > 0) {\n    return {\n      ...f,\n      from: hfrom,\n      to: hto,\n    };\n  }\n  return undefined;\n}\n\nexport function centroid(ring: number[][]): number[] {\n  let twicearea = 0;\n  let x = 0;\n  let y = 0;\n  for (let i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n    const p1 = ring[i];\n    const p2 = ring[j];\n    const f = p1[0] * p2[1] - p2[0] * p1[1];\n    twicearea += f;\n    x += (p1[0] + p2[0]) * f;\n    y += (p1[1] + p2[1]) * f;\n  }\n  const f = twicearea * 3;\n  return [x / f, y / f];\n}\n\nexport function center(feature: Feature): number[] | undefined {\n  const polygon = feature.geometries.find(geom => geom.type === 'polygon');\n  const ellipse = feature.geometries.find(geom => geom.type === 'ellipse');\n  const brush = feature.geometries.find(geom => geom.type === 'brush');\n  if (polygon) {\n    return centroid(polygon.coordinates);\n  } else if (ellipse) {\n    return [\n      ellipse.coordinates[0][0] + (ellipse.coordinates[1][0] - ellipse.coordinates[0][0]) / 2,\n      ellipse.coordinates[0][1] + (ellipse.coordinates[1][1] - ellipse.coordinates[0][1]) / 2,\n    ];\n  } else if (brush) {\n    return brush.coordinates[Math.round(brush.coordinates.length / 2)];\n  }\n  return undefined;\n}","import React from 'react';\nimport { produce } from 'immer';\n\nimport { DoorPlacement, isCCW, merge } from './lib';\nimport TempleOfClangeddin from './examples/Temple of Clanggedin.json';\n\nlet undoStack = [] as string[];\nlet redoStack = [] as string[];\n\nfunction modify(options?: { undoable: boolean }) {\n  return function (\n    state: State,\n    propertyKey: string,\n    descriptor: PropertyDescriptor\n  ) {\n    const modifierFn = descriptor.value;\n    descriptor.value = function () {\n      const args = Array.from(arguments);\n      (this as any).setState(produce(this, (newState: State) => {\n        const prev = JSON.stringify(newState.maps[newState.selection.mapIndex]);\n        modifierFn.bind(newState)(...args);\n        const curr = JSON.stringify(newState.maps[newState.selection.mapIndex]);\n        if (options && options.undoable && (undoStack.length === 0 || undoStack[undoStack.length - 1] !== prev) && curr !== prev) {\n          undoStack.push(prev);\n          if (undoStack.length > 100) undoStack.splice(0, undoStack.length - 100);\n        }\n        if (newState.hasOwnProperty('notifyChange')) {\n          newState.notifyChange();\n        }\n      }));\n    };\n  };\n}\n\nconst initialTools = () => ({\n  'pointer': {\n    selected: true,\n    group: 0,\n    polygon: true,\n    disabled: false,\n  },\n  'walls': {\n    selected: false,\n    group: 1,\n    polygon: true,\n    disabled: false,\n  },\n  'stairs': {\n    selected: false,\n    group: 1,\n    polygon: false,\n    disabled: false,\n  },\n  'doors': {\n    selected: false,\n    group: 1,\n    polygon: false,\n    disabled: false,\n    subtype: 'normal' as DoorType,\n  },\n  'decoration': {\n    selected: false,\n    group: 1,\n    polygon: false,\n    disabled: false,\n    subtype: 'statue' as DecorationType,\n  },\n  'brush': {\n    selected: false,\n    group: 2,\n    polygon: true,\n    disabled: false,\n  },\n  'rect': {\n    selected: false,\n    group: 2,\n    polygon: true,\n    disabled: false,\n  },\n  'polygon': {\n    selected: false,\n    group: 2,\n    polygon: true,\n    disabled: false,\n  },\n  'ellipse': {\n    selected: false,\n    group: 2,\n    polygon: true,\n    disabled: false,\n  },\n});\n\nexport type ToolName = keyof ReturnType<typeof initialTools>;\n\nexport interface Selection {\n  mapIndex: number\n  levelIndex: number\n  featureIndex: number | undefined\n  geometryIndex: number | undefined\n  ghostLevels: { [key: string]: boolean }\n}\n\nexport class State {\n  tools = initialTools()\n  scale = 1\n  offset = [0, 0]\n  maps = [TempleOfClangeddin] as Map[]\n  drawerOpen = false\n  drawerWidth = 400\n  selection: Selection = {\n    mapIndex: 0,\n    levelIndex: 0,\n    featureIndex: undefined,\n    geometryIndex: undefined,\n    ghostLevels: {},\n  }\n  gridSteps: number = 1\n  debug = false\n  showWelcome = true\n  setState = (state: any) => { }\n  notifyChange = () => { }\n\n  getSelectedFeature(): { feature: Feature, geometry: Geometry } | undefined {\n    if (this.selection.featureIndex === undefined) return undefined;\n    if (this.selection.geometryIndex === undefined) return undefined;\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const feature = level.features[this.selection.featureIndex];\n    return {\n      feature: feature,\n      geometry: feature.geometries[this.selection.geometryIndex],\n    };\n  }\n\n  export() {\n    let url = 'data:text/json;charset=utf-8,';\n    const map = this.maps[this.selection.mapIndex];\n    url += encodeURIComponent(JSON.stringify(map));\n    const a = document.createElement('a');\n    a.setAttribute(\"href\", url);\n    a.setAttribute(\"download\", `${map.name || 'Untitled Map'}.json`);\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n  }\n\n  @modify()\n  save(mapName: string) {\n    this.maps[this.selection.mapIndex].name = mapName;\n    if (this.maps[this.maps.length - 1].name !== '' || this.maps[this.maps.length - 1].levels[0].features.length > 0) {\n      this.maps.push({ name: '', description: '', levels: [{ features: [] }] });\n    }\n  }\n\n  @modify()\n  undo() {\n    if (undoStack.length === 0) return;\n    const prev = undoStack.pop();\n    if (!prev) return;\n    redoStack.push(JSON.parse(JSON.stringify(this.maps[this.selection.mapIndex])));\n    if (redoStack.length > 10) redoStack.splice(0, undoStack.length - 10);\n    this.maps[this.selection.mapIndex] = JSON.parse(prev);\n  }\n\n  @modify()\n  redo() {\n    if (redoStack.length === 0) return;\n    const prev = redoStack.pop();\n    undoStack.push(JSON.parse(JSON.stringify(this.maps[this.selection.mapIndex])));\n    if (undoStack.length > 10) undoStack.splice(0, undoStack.length - 10);\n    if (prev) this.maps[this.selection.mapIndex] = JSON.parse(prev);\n  }\n\n  @modify()\n  toggleWelcome() {\n    this.showWelcome = !this.showWelcome;\n  }\n\n  @modify()\n  newMap() {\n    undoStack = [];\n    redoStack = [];\n    if (this.maps[this.maps.length - 1].name !== '' || this.maps[this.maps.length - 1].levels[0].features.length > 0) {\n      this.maps.push({ name: '', description: '', levels: [{ features: [] }] });\n    }\n    this.selection = {\n      mapIndex: this.maps.length - 1,\n      levelIndex: 0,\n      featureIndex: undefined,\n      geometryIndex: undefined,\n      ghostLevels: {},\n    };\n    this.scale = 1;\n    this.offset = [0, 0];\n  }\n\n  @modify({ undoable: true })\n  addLevel() {\n    this.maps[this.selection.mapIndex].levels.push({\n      features: []\n    });\n    this.selection.levelIndex = this.maps[this.selection.mapIndex].levels.length - 1;\n    this.selection.featureIndex = undefined;\n    this.selection.geometryIndex = undefined;\n  }\n\n  @modify()\n  selectLevel(i: number) {\n    this.selection.levelIndex = i;\n    this.selection.featureIndex = undefined;\n    this.selection.geometryIndex = undefined;\n  }\n\n  @modify({ undoable: true })\n  removeLevel(i: number) {\n    const levels = this.maps[this.selection.mapIndex].levels;\n    if (levels.length <= 1) return;\n    levels.splice(i, 1);\n    if (this.selection.levelIndex === levels.length) {\n      this.selection.levelIndex--;\n    }\n    this.selection.featureIndex = undefined;\n    this.selection.geometryIndex = undefined;\n  }\n\n  @modify()\n  setDebug(debug: boolean) {\n    this.debug = debug;\n  }\n\n  @modify()\n  setGridSteps(gridSteps: number) {\n    this.gridSteps = gridSteps;\n  }\n\n  @modify({ undoable: true })\n  handleDrag(from: number[], to: number[]) {\n    if (from[0] === to[0] && from[1] === to[1]) return;\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const features = level.features;\n    if (this.tools.stairs.selected) {\n      features.push({\n        properties: {\n          type: 'other',\n        },\n        geometries: [{\n          type: 'stairs',\n          coordinates: [from, to],\n        }],\n      });\n    } else if (this.tools.decoration.selected) {\n      features.push({\n        properties: {\n          type: 'other',\n        },\n        geometries: [{\n          type: 'decoration',\n          coordinates: [from, to],\n          subtype: this.tools.decoration.subtype,\n        }],\n      });\n    } else if (this.tools.rect.selected) {\n      features.push({\n        geometries: [{\n          type: 'polygon',\n          coordinates: [\n            [from[0], from[1]],\n            [to[0], from[1]],\n            [to[0], to[1]],\n            [from[0], to[1]],\n            [from[0], from[1]]\n          ],\n        }],\n        properties: {\n          type: 'room',\n        },\n      });\n    } else if (this.tools.ellipse.selected) {\n      features.push({\n        geometries: [{\n          type: 'ellipse',\n          coordinates: [from, to],\n        }],\n        properties: {\n          type: 'room',\n        },\n      });\n    } else if (this.tools.walls.selected) {\n      features.push({\n        geometries: [{\n          type: 'line',\n          coordinates: [from, to],\n        }],\n        properties: {\n          type: 'other',\n        },\n      });\n    } else if (this.selection.featureIndex !== undefined) {\n      const selection = features[this.selection.featureIndex];\n      if (selection !== undefined) {\n        const deltaDrag = [to[0] - from[0], to[1] - from[1]];\n        selection.geometries.forEach(geometry => {\n          geometry.coordinates.forEach(p => {\n            p[0] += deltaDrag[0];\n            p[1] += deltaDrag[1];\n          });\n        });\n        return;\n      }\n    }\n  }\n\n  @modify({ undoable: true })\n  handlePolygon(points: number[][]) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const features = level.features;\n    if (!isCCW(points)) {\n      points.reverse();\n    }\n    features.push({\n      geometries: [{\n        type: 'polygon',\n        coordinates: points,\n      }],\n      properties: {\n        type: this.tools.walls.selected ? 'room' : 'other',\n      },\n    });\n  }\n\n  @modify({ undoable: true })\n  handleBrush(points: number[][]) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const features = level.features;\n    if (this.tools.walls.selected && this.tools.brush.selected) {\n      features.push({\n        geometries: [{\n          type: 'brush',\n          coordinates: points,\n        }],\n        properties: {\n          type: 'room',\n        },\n      });\n    }\n  }\n\n  @modify({ undoable: true })\n  handleDelete() {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const features = level.features;\n    if (this.selection.featureIndex === undefined) return;\n    if (this.selection.geometryIndex === undefined) return;\n    const feature = features[this.selection.featureIndex];\n    if (this.selection.geometryIndex === 0 || feature.geometries.length === 1) {\n      features.splice(this.selection.featureIndex, 1);\n    } else {\n      feature.geometries.splice(this.selection.geometryIndex, 1);\n    }\n    this.selection.featureIndex = undefined;\n    this.selection.geometryIndex = undefined;\n  }\n\n  @modify({ undoable: true })\n  addDoor(door: DoorPlacement) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const feature = level.features[door.feature];\n    feature.geometries.push({\n      type: 'door',\n      coordinates: [door.from, door.to],\n      subtype: this.tools.doors.subtype,\n    });\n  }\n\n  @modify({ undoable: true })\n  handleGroup(featureIndex: number, geometryIndex: number) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const features = level.features;\n    if (this.selection.featureIndex === undefined) return;\n    if (this.selection.geometryIndex === undefined) return;\n    const selectedFeature = features[this.selection.featureIndex];\n    if (this.selection.featureIndex === featureIndex) {\n      if (selectedFeature.geometries.length === 1) return;\n      const geom = selectedFeature.geometries[geometryIndex];\n      selectedFeature.geometries.splice(geometryIndex, 1);\n      features.push({\n        properties: {\n          type: ['polygon', 'ellipse'].includes(geom.type) ? 'room' : 'other',\n        },\n        geometries: [geom],\n      });\n    } else {\n      const geom1 = selectedFeature.geometries.find(geom => geom.type === 'polygon');\n      const geom2 = features[featureIndex].geometries[geometryIndex];\n      if (geom1 && geom2.type === 'polygon') {\n        const mergedGeoms = merge(selectedFeature.geometries.filter(geom => geom.type === 'polygon'), geom2);\n        const prevGeoms = selectedFeature.geometries.filter(geom => geom.type !== 'polygon');\n        selectedFeature.geometries = prevGeoms.concat(mergedGeoms);\n      } else {\n        selectedFeature.geometries = selectedFeature.geometries.concat(features[featureIndex].geometries);\n      }\n      features.splice(featureIndex, 1);\n      if (this.selection.featureIndex > featureIndex) this.selection.featureIndex--;\n    }\n  }\n\n  @modify()\n  setSelectedTool(name: ToolName) {\n    const tool = this.tools[name];\n    if (tool.selected) {\n      tool.selected = false;\n      return;\n    }\n    if (tool.group === 0) {\n      Object.values(this.tools).forEach(t => {\n        t.selected = false;\n      });\n      tool.selected = true;\n      return;\n    } else {\n      Object.values(this.tools).forEach(t => {\n        if (t.group === 0) t.selected = false;\n      });\n    }\n    Object.values(this.tools).forEach(t => {\n      if (t.group === tool.group) t.selected = false;\n    });\n    if (!tool.polygon) {\n      Object.values(this.tools).forEach(t => {\n        if (t.group === 2) {\n          t.selected = false;\n          t.disabled = true;\n        }\n      });\n    } else {\n      Object.values(this.tools).forEach(t => {\n        if (t.group === 2) {\n          t.disabled = false;\n        }\n      });\n    }\n    tool.selected = true;\n  }\n\n  @modify()\n  setToolOption(name: ToolName, option: string) {\n    const tool = this.tools[name];\n    (tool as any).subtype = option;\n  }\n\n  @modify()\n  setSelection(selection: Selection) {\n    if (selection.mapIndex !== this.selection.mapIndex) {\n      undoStack = [];\n      redoStack = [];\n    }\n    this.selection = selection;\n  }\n\n  @modify()\n  setOffset(offset: number[]) {\n    this.offset = offset;\n  }\n\n  @modify()\n  setZoom(scale: number, offset: number[]) {\n    this.scale = scale;\n    this.offset = offset;\n  }\n\n  @modify()\n  setDrawerOpen(open: boolean) {\n    this.drawerOpen = open;\n  }\n\n  @modify()\n  setDrawerWidth(width: number) {\n    this.drawerWidth = width;\n  }\n\n  @modify()\n  setMapDescription(desc: Description) {\n    this.maps[this.selection.mapIndex].name = desc.name;\n    this.maps[this.selection.mapIndex].description = desc.description;\n  }\n\n  @modify()\n  setLevelDescription(desc: Description) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    level.name = desc.name;\n    level.description = desc.description;\n  }\n\n  @modify()\n  setFeatureDescription(desc: Description | undefined) {\n    if (this.selection.featureIndex === undefined) return;\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const feature = level.features[this.selection.featureIndex];\n    Object.assign(feature.properties, desc);\n  }\n\n  @modify()\n  setFeatureOrder(sourceIndex: number, destIndex: number) {\n    const level = this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];\n    const [removed] = level.features.splice(sourceIndex, 1);\n    level.features.splice(destIndex, 0, removed);\n  }\n\n  @modify()\n  reset() {\n    Object.assign(this, new State());\n  }\n}\n\nexport interface Map extends Description {\n  levels: Level[]\n}\n\nexport type Geometry = Polygon | Ellipse | Line | Brush | Door | Stairs | Decoration\n\nexport interface Polygon {\n  type: 'polygon'\n  coordinates: number[][]\n}\n\nexport interface Ellipse {\n  type: 'ellipse'\n  coordinates: number[][]\n}\n\nexport interface Line {\n  type: 'line'\n  coordinates: number[][]\n}\n\nexport interface Brush {\n  type: 'brush'\n  coordinates: number[][]\n}\n\nexport type DoorType = 'normal' | 'secret'\n\nexport interface Door {\n  type: 'door'\n  coordinates: number[][]\n  subtype: DoorType\n}\n\nexport interface Stairs {\n  type: 'stairs'\n  coordinates: number[][]\n}\n\nexport type DecorationType = 'statue' | 'column' | 'stalacmite';\n\nexport interface Decoration {\n  type: 'decoration'\n  coordinates: number[][]\n  subtype: DecorationType\n}\n\nexport type FeatureType = 'room' | 'text' | 'other'\n\nexport interface FeatureProperties extends Description {\n  type: FeatureType\n}\n\nexport interface Feature {\n  geometries: Geometry[]\n  properties: FeatureProperties\n}\n\nexport interface Level extends Description {\n  features: Feature[]\n}\n\nexport interface Description {\n  name?: string\n  description?: string\n}\n\nexport const Context = React.createContext(new State());\n","import { css } from 'astroturf';\n\nexport const DS = css`\n  .button {\n    background: transparent;\n    border: none;\n    outline: none;\n    margin: 4px;\n    padding: 8px 12px;\n    color: white;\n    font-size: 18px;\n    font-weight: 600;\n    box-sizing: border-box;\n    border-radius: 2px;\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\n  }\n\n  .button:hover {\n    background: #505050;\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\n  }\n\n  .button:active {\n    outline: none;\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\n  }\n\n  .buttonSmall {\n    background: transparent;\n    border: none;\n    outline: none;\n    margin: 4px;\n    color: white;\n    font-size: 18px;\n    font-weight: 600;\n    box-sizing: border-box;\n    border-radius: 2px;\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\n  }\n\n  .buttonSmall:hover {\n    background: #505050;\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\n  }\n\n  .buttonSmall:active {\n    outline: none;\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\n  }\n\n  .danger {\n    background: #A20B25;\n  }\n\n  .danger:hover {\n    background: #a03e4e;\n  }\n\n  .input {\n    font-size: 18px;\n    background: transparent;\n    color: white;\n    border: none;\n    border-bottom: 1px solid white;\n    padding: 4px;\n    margin: 4px;\n    margin-bottom: 1px;\n  }\n  \n  .input:focus {\n    outline: none;\n    border-bottom: 2px solid white;\n    margin-bottom: 0px;\n  }\n\n  .toolbar {\n    display: flex;\n    flex-direction: column;\n    background: #000;\n    border-radius: 12px;\n    padding: 8px;\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\n    color: white;\n  }\n  .toolbar svg {\n    color: white;\n    font-size: 24px;\n  }\n  .toolbar .selected svg {\n    color: black;\n  }\n  .toolbar button {\n    background: black;\n    width: 50px;\n    height: 50px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n  }\n  .toolbar button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  .toolbar button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n  .toolbar button.selected {\n    background: #bbb;\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\n  }\n  .toolbar button[disabled] {\n    background: #444;\n    box-shadow: none;\n  }\n`;","import React, { useContext } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport classNames from 'classnames';\nimport { css } from 'astroturf';\nimport { faMinus, faPlus } from '@fortawesome/free-solid-svg-icons';\n\nimport { DS } from './design_system';\nimport { Context } from './State';\nimport { clamp } from './lib';\nimport { CanvasRenderer } from './Canvas';\n\nconst classes = css`\n  .zoom button {\n    background: black;\n    width: 24px;\n    height: 24px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n  }\n  .zoom svg {\n    color: white;\n    font-size: 12px;\n  }\n  .zoom button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  .zoom button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n`;\n\nexport default function Zoom(props: { renderer?: CanvasRenderer }) {\n  const state = useContext(Context);\n  const zoom = (mult: number) => () => {\n    const renderer = props.renderer;\n    if (!renderer) return;\n    const { scale, offset } = state;\n    const newScale = clamp(scale * mult, 0.2, 4);\n    const mid = [renderer.canvas.width / 2, renderer.canvas.height / 2];\n    const worldPos = renderer.canvasToWorld(mid);\n    const newWorldPos = [mid[0] / newScale - offset[0], mid[1] / newScale - offset[1]];\n    const newOffset = [\n      offset[0] - (worldPos[0] - newWorldPos[0]),\n      offset[1] - (worldPos[1] - newWorldPos[1])\n    ];\n    window.requestAnimationFrame(() => {\n      state.setZoom(newScale, newOffset);\n    });\n  }\n  return <div className={classNames(DS.toolbar, classes.zoom)} style={{ position: 'absolute', top: '50px', right: '50px' }}>\n    <button onClick={zoom(1.1)}><FontAwesomeIcon icon={faPlus}></FontAwesomeIcon></button>\n    <button onClick={zoom(0.9)}><FontAwesomeIcon icon={faMinus}></FontAwesomeIcon></button>\n  </div>;\n}","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport seedrandom from 'seedrandom';\n\nimport {\n  bbox,\n  center,\n  colorToIndex,\n  detectDoorPlacement,\n  dist,\n  indexToColor,\n  isCCW,\n  lerp,\n  lerp2,\n} from './lib';\nimport { Context, DecorationType, DoorType, Geometry, Level, State } from './State';\nimport Zoom from './Zoom';\n\nconst backgroundColor = '#D9D2BF';\nconst floorColor = '#F1ECE0';\nconst wallColor = '#000';\nconst selectionFillColor = '#2f557466';\nconst selectionStrokeColor = '#2f5574';\nconst dragFillColor = '#2f557466';\nconst dragStrokeColor = '#2f5574';\nconst hoverFillColor = '#668dad66';\nconst hoverStrokeColor = '#668dad';\nconst pointColor = '#fff238';\nconst specialColors = [\n  selectionFillColor, selectionStrokeColor,\n  dragFillColor, dragStrokeColor,\n  hoverFillColor, hoverStrokeColor,\n];\n\ntype Style = string | CanvasPattern | CanvasGradient;\n\nexport class CanvasRenderer {\n  mouse?: number[] = undefined\n  mouseDown: boolean = false\n  drag?: {\n    start: number[]\n    end: number[]\n  }\n  specialKeys = {\n    shift: false,\n    alt: false,\n    ctrl: false,\n    space: false,\n  }\n  points: number[][] = []\n  polygonToolSelected: boolean = false\n  hover?: {\n    featureIndex: number | undefined\n    geometryIndex: number | undefined\n  }\n  size: number = 30\n  fps: number = 0\n  requestID?: number\n  appState = new State()\n  canvas: HTMLCanvasElement\n  ctx: CanvasRenderingContext2D\n  bufferCanvas: HTMLCanvasElement\n  bufferCtx: CanvasRenderingContext2D\n  textures: { [key: string]: CanvasPattern } = {}\n  dirty: Date = new Date()\n  mode: 'edit' | 'print'\n  level?: number\n\n  constructor(canvas: HTMLCanvasElement, mode: 'edit' | 'print', level?: number) {\n    const ctx = canvas.getContext('2d', { alpha: true });\n    if (ctx === null) {\n      throw new Error('canvas has null rendering context');\n    }\n    this.canvas = canvas;\n    this.ctx = ctx;\n    this.requestID = requestAnimationFrame(this.render);\n\n    this.bufferCanvas = document.createElement('canvas');\n    this.bufferCanvas.width = this.canvas.width;\n    this.bufferCanvas.height = this.canvas.height;\n    const bufferCtx = this.bufferCanvas.getContext('2d', { alpha: true });\n    if (bufferCtx === null) {\n      throw new Error('canvas has null rendering context');\n    }\n    this.bufferCtx = bufferCtx;\n    this.mode = mode;\n    this.level = level;\n  }\n\n  attachListeners() {\n    if (this.mode === 'print') return;\n    this.canvas.addEventListener('touchstart', this.onMouseDown);\n    this.canvas.addEventListener('mousedown', this.onMouseDown);\n    this.canvas.addEventListener('mouseup', this.onMouseUp);\n    this.canvas.addEventListener('touchend', this.onMouseUp);\n    this.canvas.addEventListener('mousemove', this.onMouseMove);\n    this.canvas.addEventListener('touchmove', this.onMouseMove);\n    window.addEventListener('keydown', this.onKeyDown);\n    window.addEventListener('keyup', this.onKeyUp);\n    window.addEventListener('wheel', this.onWheel, { passive: false });\n  }\n\n  detachListeners() {\n    if (this.mode === 'print') return;\n    this.canvas.removeEventListener('mousedown', this.onMouseDown);\n    this.canvas.removeEventListener('mouseup', this.onMouseUp);\n    this.canvas.removeEventListener('mousemove', this.onMouseMove);\n    window.removeEventListener('keydown', this.onKeyDown);\n    window.removeEventListener('keyup', this.onKeyUp);\n    window.removeEventListener('wheel', this.onWheel);\n  }\n\n  loadTextures(filenames: string[]) {\n    const buf = document.createElement('canvas');\n    buf.width = 1024;\n    buf.height = 1024;\n    const bufCtx = buf.getContext('2d', { alpha: true });\n    if (bufCtx === null) {\n      throw new Error('unable to create pattern');\n    }\n    filenames.forEach(filename => {\n      const img = document.createElement('img');\n      img.width = 100;\n      img.height = 100;\n      img.onload = () => {\n        bufCtx.drawImage(img, 0, 0);\n        const pattern = this.ctx.createPattern(buf, 'repeat');\n        if (pattern === null) {\n          throw new Error('unable to create pattern');\n        }\n        const matrix = new DOMMatrix();\n        pattern.setTransform(matrix.scale(0.005));\n        this.textures[filename] = pattern;\n      };\n      img.src = `${process.env.PUBLIC_URL}/textures/${filename}`;\n    });\n  }\n\n  onMouseDown = (e: MouseEvent | TouchEvent) => {\n    this.dirty = new Date();\n    this.mouseDown = true;\n    const { mouse } = this;\n    if (e instanceof MouseEvent && e.button === 2) return;\n    if (mouse) {\n      this.drag = {\n        start: this.canvasToTile(mouse),\n        end: this.canvasToTile(mouse),\n      };\n    }\n    if (this.appState.tools.pointer.selected) {\n      const selectedFeatureIndex = this.appState.selection.featureIndex;\n      const hoverFeatureIndex = this.hover?.featureIndex;\n      const hoverGeometryIndex = this.hover?.geometryIndex;\n      if (e.shiftKey && selectedFeatureIndex !== undefined && hoverFeatureIndex !== undefined && hoverGeometryIndex !== undefined) {\n        this.appState.handleGroup(hoverFeatureIndex, hoverGeometryIndex);\n      } else {\n        this.appState.setSelection({\n          ...this.appState.selection,\n          featureIndex: this.hover?.featureIndex,\n          geometryIndex: this.hover?.geometryIndex,\n        });\n      }\n    } else if (this.appState.tools.doors.selected && mouse) {\n      const door = detectDoorPlacement(\n        this.worldToTile(this.canvasToWorld(mouse), false),\n        this.appState.maps[this.appState.selection.mapIndex].levels[this.appState.selection.levelIndex].features,\n        e.shiftKey);\n      if (door) this.appState.addDoor(door);\n    }\n  }\n\n  onMouseUp = () => {\n    this.dirty = new Date();\n    this.mouseDown = false;\n    if (this.mouse && this.appState.tools.polygon.selected) {\n      const pos = this.canvasToTile(this.mouse);\n      if (this.points.length >= 1 && dist(this.points[0], pos) < 1) {\n        this.appState.handlePolygon(this.points);\n        this.points = [];\n      } else {\n        this.points.push(pos);\n      }\n    } else if (this.appState.tools.brush.selected) {\n      this.appState.handleBrush(this.points);\n      this.points = [];\n      this.drag = undefined;\n    } else if (this.drag) {\n      let [from, to] = [this.drag.start, this.drag.end];\n      if (\n        this.appState.tools.rect.selected ||\n        this.appState.tools.ellipse.selected) {\n        const bounds = bbox([from, to]);\n        from = bounds.sw;\n        to = bounds.ne;\n      }\n      this.appState.handleDrag(from, to);\n      this.drag = undefined;\n      this.points = [];\n    }\n  }\n\n  onMouseMove = (event: MouseEvent | TouchEvent) => {\n    this.dirty = new Date();\n    if ('touches' in event && event.target) {\n      const rect = (event.target as HTMLElement).getBoundingClientRect();\n      this.mouse = [event.touches[0].clientX - rect.left, event.touches[0].clientY - rect.top];\n    } else if ('offsetX' in event) {\n      this.mouse = [event.offsetX, event.offsetY];\n    }\n    if (this.mouse && this.mouseDown && this.drag) {\n      if (this.specialKeys.space) {\n        const end = this.canvasToWorld(this.mouse);\n        const delta = [(this.drag.start[0] * this.size) - end[0], (this.drag.start[1] * this.size) - end[1]];\n        let newOffset = this.appState.offset;\n        newOffset[0] -= delta[0];\n        newOffset[1] -= delta[1];\n        this.drag.start = this.canvasToTile(this.mouse);\n        this.drag.end = this.canvasToTile(this.mouse);\n        window.requestAnimationFrame(() => {\n          this.appState.setOffset(newOffset);\n        });\n      } else {\n        this.drag.end = this.canvasToTile(this.mouse);\n        if (this.appState.tools.brush.selected) {\n          this.points.push(this.worldToTile(this.canvasToWorld(this.mouse), false));\n        }\n      }\n    }\n  }\n\n  onWheel = (event: WheelEvent) => {\n    if (event.x === undefined || event.y === undefined || document.elementFromPoint(event.x, event.y) !== this.canvas) return;\n    event.stopPropagation();\n    event.preventDefault();\n    this.dirty = new Date();\n    const { mouse } = this;\n    const { scale, offset } = this.appState;\n    if (!mouse) return;\n    offset[0] -= event.deltaX * scale;\n    offset[1] -= event.deltaY * scale;\n    window.requestAnimationFrame(() => {\n      this.appState.setOffset(offset);\n    });\n  }\n\n  onKeyDown = (event: KeyboardEvent) => {\n    this.dirty = new Date();\n    if (event.key === 'Shift') this.specialKeys.shift = true;\n    if (event.key === 'Control') this.specialKeys.ctrl = true;\n    if (event.key === 'Alt') this.specialKeys.alt = true;\n    if (document.activeElement !== document.body) return;\n    const { appState } = this;\n    if (event.key === 'Backspace' || event.key === 'Delete') {\n      appState.handleDelete();\n    }\n    if (event.key === 'z' && this.specialKeys.ctrl) appState.undo();\n    if (event.key === 'y' && this.specialKeys.ctrl) appState.redo();\n    if (event.key === ' ') {\n      this.canvas.style.cursor = \"pointer\";\n      this.specialKeys.space = true;\n      event.preventDefault();\n    }\n  }\n\n  onKeyUp = (event: KeyboardEvent) => {\n    this.dirty = new Date();\n    if (event.key === 'Shift') this.specialKeys.shift = false;\n    if (event.key === 'Control') this.specialKeys.ctrl = false;\n    if (event.key === 'Alt') this.specialKeys.alt = false;\n    if (event.key === ' ') {\n      this.canvas.style.cursor = \"auto\";\n      this.specialKeys.space = false;\n    }\n  }\n\n  // canvas coordinates to world coordinates\n  canvasToWorld = (p: number[]): number[] => {\n    const { offset, scale } = this.appState;\n    return [p[0] / scale - offset[0], p[1] / scale - offset[1]];\n  }\n\n  // world coordinates to canvas coordinates\n  worldToCanvas = (p: number[]): number[] => {\n    const { offset, scale } = this.appState;\n    return [(p[0] + offset[0]) * scale, (p[1] + offset[1]) * scale];\n  }\n\n  // world coordinates to tile coordinates\n  worldToTile = (p: number[], round = true): number[] => {\n    if (round) {\n      const S = this.size / this.appState.gridSteps;\n      return [Math.round(p[0] / S) / this.appState.gridSteps, Math.round(p[1] / S) / this.appState.gridSteps];\n    }\n    return [p[0] / this.size, p[1] / this.size];\n  }\n\n  canvasToTile = (p: number[]) => {\n    return this.worldToTile(this.canvasToWorld(p));\n  }\n\n  zoomToCenter(from: number[], to: number[], scale: number) {\n    this.ctx.scale(scale, scale);\n    this.ctx.translate(\n      (from[0] - (to[0] * scale)) / scale,\n      (from[1] - (to[1] * scale)) / scale);\n  }\n\n  renderTextCenter(text: string, font: string) {\n    this.ctx.font = font;\n    const m = this.ctx.measureText(text);\n    let h = m.actualBoundingBoxAscent + m.actualBoundingBoxDescent;\n    this.ctx.fillText(text, -m.width / 2, h);\n  }\n\n  renderFPS(time: number) {\n    const fps = this.fps.toFixed(0);\n    this.ctx.save();\n    this.ctx.translate(this.canvas.width - 48, 12);\n    this.ctx.fillStyle = '#000';\n    this.renderTextCenter(fps, \"18px Roboto Mono, monospace\");\n    this.ctx.restore();\n  }\n\n  clearScreen() {\n    const { canvas, ctx, bufferCanvas } = this;\n    if (this.mode === 'edit') {\n      ctx.fillStyle = backgroundColor;\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n    } else {\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n    if (bufferCanvas.width !== canvas.width || bufferCanvas.height !== canvas.height) {\n      bufferCanvas.width = canvas.width;\n      bufferCanvas.height = canvas.height;\n    }\n  }\n\n  drawGrid() {\n    const { canvas, ctx } = this;\n    const iT = ctx.getTransform().inverse();\n    const min = iT.transformPoint({ x: 0, y: 0 });\n    const max = iT.transformPoint({ x: canvas.width, y: canvas.height });\n    ctx.lineWidth = 0.01;\n    ctx.strokeStyle = '#000';\n    for (let x = Math.floor(min.x); x <= max.x; x++) {\n      ctx.beginPath();\n      ctx.moveTo(x, min.y);\n      ctx.lineTo(x, max.y);\n      ctx.stroke();\n    }\n    for (let y = Math.floor(min.y); y <= max.y; y++) {\n      ctx.beginPath();\n      ctx.moveTo(min.x, y);\n      ctx.lineTo(max.x, y);\n      ctx.stroke();\n    }\n    if (this.appState.gridSteps !== 1 && this.mode === 'edit') {\n      ctx.lineWidth = 0.005;\n      ctx.strokeStyle = '#666666';\n      for (let x = Math.floor(min.x); x <= max.x; x += 1 / this.appState.gridSteps) {\n        ctx.beginPath();\n        ctx.moveTo(x, min.y);\n        ctx.lineTo(x, max.y);\n        ctx.stroke();\n      }\n      for (let y = Math.floor(min.y); y <= max.y; y += 1 / this.appState.gridSteps) {\n        ctx.beginPath();\n        ctx.moveTo(min.x, y);\n        ctx.lineTo(max.x, y);\n        ctx.stroke();\n      }\n    }\n  }\n\n  drawMousePos(mouse: number[]) {\n    const { ctx } = this;\n    ctx.save();\n    const p = this.worldToTile(this.canvasToWorld(mouse), true);\n    ctx.fillStyle = '#000';\n    ctx.beginPath();\n    ctx.arc(p[0], p[1], 0.1, 0, 2 * Math.PI);\n    ctx.fill();\n\n    if (this.appState.debug) {\n      const font = \"0.5px Roboto, sans-serif\";\n      ctx.translate(p[0], p[1] - 1);\n      this.renderTextCenter(`Mouse: ${mouse[0].toFixed(0)},${mouse[1].toFixed(0)}`, font);\n      ctx.translate(0, -0.5);\n      this.renderTextCenter(`Tile: ${p[0].toFixed(0)},${p[1].toFixed(0)}`, font);\n    }\n    ctx.restore();\n  }\n\n  drawDrag() {\n    const { drag, appState } = this;\n    if (!drag) return;\n    const { start, end } = drag;\n    if (dist(start, end) > 1 && appState.tools.rect.selected) {\n      this.drawGeometry(\n        { type: 'polygon', coordinates: [start, [start[0], end[1]], end, [end[0], start[1]]] },\n        dragFillColor, dragStrokeColor);\n    } else if (dist(start, end) > 1 && appState.tools.stairs.selected) {\n      this.drawStairs([start, end], dragFillColor, dragStrokeColor);\n    } else if (dist(start, end) > 1 && appState.tools.decoration.selected) {\n      this.drawDecoration(appState.tools.decoration.subtype, [start, end], dragFillColor, dragStrokeColor);\n    } else if (dist(start, end) > 1 && appState.tools.ellipse.selected) {\n      const box = bbox([start, end]);\n      this.drawEllipse([box.sw, box.ne], dragFillColor, dragStrokeColor);\n    } else {\n      this.drawLine([start, end], 0.1, dragStrokeColor);\n    }\n  }\n\n  drawGeometry(geometry: Geometry, fill?: Style, stroke?: Style, indexColor?: string) {\n    if (geometry.type === 'polygon') {\n      this.drawPolygon(geometry.coordinates, fill || indexColor, stroke || indexColor);\n    } else if (geometry.type === 'ellipse') {\n      this.drawEllipse(geometry.coordinates, fill || indexColor, stroke || indexColor);\n    } else if (geometry.type === 'line') {\n      this.drawLine(geometry.coordinates, indexColor !== undefined ? 0.5 : 0.1, stroke || indexColor);\n    } else if (geometry.type === 'brush') {\n      this.drawBrush(geometry.coordinates, fill || indexColor, stroke || indexColor);\n    } else if (geometry.type === 'door') {\n      this.drawDoor(geometry.subtype, geometry.coordinates, stroke || indexColor);\n    } else if (geometry.type === 'stairs') {\n      this.drawStairs(geometry.coordinates, indexColor, stroke || indexColor);\n    } else if (geometry.type === 'decoration') {\n      this.drawDecoration(geometry.subtype, geometry.coordinates, indexColor, stroke || indexColor);\n    }\n  }\n\n  drawPolygon(points: number[][], fill?: Style, stroke?: Style) {\n    const { ctx } = this;\n    this.pathPoints(points, true);\n    if (fill) {\n      ctx.fillStyle = fill;\n      ctx.fill();\n    }\n    if (stroke) {\n      ctx.strokeStyle = stroke;\n      ctx.lineWidth = 0.1;\n      if (stroke instanceof CanvasGradient || stroke instanceof CanvasPattern) ctx.lineWidth = 2;\n      ctx.stroke();\n    }\n    if (fill && typeof fill === 'string' && specialColors.includes(fill)) {\n      this.drawPoints(points);\n      const box = bbox(points);\n      ctx.fillStyle = '#000';\n      ctx.save();\n      ctx.translate(box.sw[0] + box.w / 2, box.ne[1] - 1);\n      this.renderTextCenter(`${box.w * 5}ft x ${box.h * 5}ft`, \"1px Roboto, sans-serif\");\n      ctx.restore();\n    }\n  }\n\n  drawEllipse(points: number[][], fill?: Style, stroke?: Style) {\n    const { ctx } = this;\n    this.pathEllipse(points, true);\n    if (fill) {\n      ctx.fillStyle = fill;\n      ctx.fill();\n    }\n    if (stroke) {\n      ctx.strokeStyle = stroke;\n      ctx.lineWidth = 0.1;\n      ctx.stroke();\n    }\n    if (fill && typeof fill === 'string' && specialColors.includes(fill)) {\n      const box = bbox(points);\n      this.drawPoints([box.sw, [box.sw[0], box.ne[1]], box.ne, [box.ne[0], box.sw[1]]]);\n      ctx.fillStyle = '#000';\n      ctx.save();\n      ctx.translate(box.sw[0] + box.w / 2, box.ne[1] - 1);\n      this.renderTextCenter(`${box.w * 5}ft x ${box.h * 5}ft`, \"1px Roboto, sans-serif\");\n      ctx.restore();\n    }\n  }\n\n  drawLine(points: number[][], width: number, stroke?: Style) {\n    const { ctx } = this;\n    this.pathPoints(points);\n    if (stroke) {\n      ctx.strokeStyle = stroke;\n      ctx.lineWidth = width;\n      ctx.stroke();\n    }\n  }\n\n  drawBrush(points: number[][], fill?: Style, stroke?: Style) {\n    const { ctx } = this;\n    this.pathPoints(points);\n    if (fill) {\n      ctx.strokeStyle = fill;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = 0.9;\n      ctx.stroke();\n    }\n    this.ctx.globalCompositeOperation = 'destination-over';\n    if (stroke) {\n      ctx.strokeStyle = stroke;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = 1.1;\n      ctx.stroke();\n    }\n    this.ctx.globalCompositeOperation = 'source-over';\n    if (fill && typeof fill === 'string' && specialColors.includes(fill)) {\n      this.drawPoints(points, 0.1);\n    }\n  }\n\n  drawDoor(type: DoorType, points: number[][], stroke?: Style) {\n    switch (type) {\n      case 'normal':\n        this.drawNormalDoor(points, stroke);\n        break;\n      case 'secret':\n        this.drawSecretDoor(points, stroke);\n        break;\n      default:\n        throw new Error(`unsupported door type ${type}`);\n    }\n  }\n\n  drawNormalDoor(points: number[][], stroke?: Style) {\n    const { ctx } = this;\n    const [from, to] = points;\n    const a = lerp2(0.1, from, to);\n    const b = lerp2(0.9, from, to);\n    if (stroke) {\n      ctx.strokeStyle = stroke;\n      ctx.lineCap = 'butt';\n      ctx.lineWidth = 0.1;\n      ctx.beginPath();\n      ctx.moveTo(from[0], from[1]);\n      ctx.lineTo(to[0], to[1]);\n      ctx.stroke();\n      ctx.lineWidth = 0.3;\n      ctx.beginPath();\n      ctx.moveTo(a[0], a[1]);\n      ctx.lineTo(b[0], b[1]);\n      ctx.stroke();\n    }\n  }\n\n  drawSecretDoor(points: number[][], stroke?: Style) {\n    const { ctx } = this;\n    const [from, to] = points;\n    if (stroke) {\n      const l = Math.max(Math.abs(from[0] - to[0]), Math.abs(from[1] - to[1]));\n      ctx.font = `${l}px Helvetica`;\n      const m = this.ctx.measureText('S');\n      let h = m.actualBoundingBoxAscent + m.actualBoundingBoxDescent;\n      let w = m.actualBoundingBoxLeft - m.actualBoundingBoxRight;\n      const [cx, cy] = [w / 2, h / 2];\n      ctx.save();\n      ctx.fillStyle = stroke;\n      ctx.fillText('S', from[0] + (to[0] - from[0]) / 2 + cx, from[1] + (to[1] - from[1]) / 2 + cy);\n      ctx.restore();\n    }\n  }\n\n  drawStairs(points: number[][], fill?: Style, stroke?: Style) {\n    if (!stroke) return;\n    const { ctx } = this;\n    const [from, to] = points;\n    const w = Math.abs(to[0] - from[0]);\n    const h = Math.abs(to[1] - from[1]);\n    const sx = Math.sign(to[0] - from[0]);\n    const sy = Math.sign(to[1] - from[1]);\n    const L = Math.max(w, h);\n    const W = Math.min(w, h);\n    ctx.strokeStyle = stroke;\n    ctx.lineWidth = 0.1;\n    ctx.lineCap = 'butt';\n    for (let i = 0; i < L; i += 0.5) {\n      const l = lerp(i / (L + .5), 0.1, W);\n      ctx.beginPath();\n      if (w > h) {\n        ctx.moveTo(from[0] + i * sx, Math.min(from[1], to[1]) + (W - l) / 2);\n        ctx.lineTo(from[0] + i * sx, Math.min(from[1], to[1]) + (W - l) / 2 + l);\n      } else {\n        ctx.moveTo(Math.min(from[0], to[0]) + (W - l) / 2, from[1] + i * sy);\n        ctx.lineTo(Math.min(from[0], to[0]) + (W - l) / 2 + l, from[1] + i * sy);\n      }\n      ctx.stroke();\n    }\n    ctx.lineWidth = 0.05;\n    ctx.beginPath();\n    if (w > h) {\n      ctx.moveTo(from[0], from[1]);\n      ctx.lineTo(to[0], from[1]);\n      ctx.lineTo(to[0], to[1]);\n      ctx.lineTo(from[0], to[1]);\n    } else {\n      ctx.moveTo(from[0], from[1]);\n      ctx.lineTo(from[0], to[1]);\n      ctx.lineTo(to[0], to[1]);\n      ctx.lineTo(to[0], from[1]);\n    }\n    ctx.stroke();\n    if (fill) {\n      ctx.closePath();\n      ctx.fillStyle = fill;\n      ctx.fill();\n    }\n    if (stroke && typeof stroke === 'string' && specialColors.includes(stroke)) {\n      this.drawPoints(points);\n    }\n  }\n\n  drawDecoration(type: DecorationType, points: number[][], fill?: Style, stroke?: Style) {\n    switch (type) {\n      case 'statue':\n        this.drawStatue(points, fill, stroke);\n        break;\n      case 'column':\n        this.drawColumn(points, fill);\n        break;\n      case 'stalacmite':\n        this.drawStalacmite(points, fill, stroke);\n        break;\n      default:\n        throw new Error(`unsupported decoration type ${type}`);\n    }\n  }\n\n  drawStatue(points: number[][], fill?: Style, stroke?: Style) {\n    if (!stroke) return;\n    const { ctx } = this;\n    const [from, to] = points;\n    const r = Math.max(Math.abs(to[0] - from[0]), Math.abs(to[1] - from[1])) / 2;\n    const [cx, cy] = [from[0] + r, from[1] + r];\n    ctx.strokeStyle = stroke;\n    ctx.lineWidth = 0.05;\n    ctx.beginPath();\n    ctx.ellipse(cx, cy, r, r, 0, 0, 2 * Math.PI);\n    ctx.stroke();\n    if (fill) {\n      ctx.closePath();\n      ctx.fillStyle = fill;\n      ctx.fill();\n    }\n    const r2 = r * 0.4;\n    ctx.beginPath();\n    let theta = -0.1 * Math.PI;\n    for (let i = 0; i < 10; i++) {\n      if (i === 0) {\n        ctx.moveTo(cx + r * Math.cos(theta), cy + r * Math.sin(theta));\n      } else {\n        ctx.lineTo(cx + r * Math.cos(theta), cy + r * Math.sin(theta));\n      }\n      theta += 0.2 * Math.PI;\n      ctx.lineTo(cx + r2 * Math.cos(theta), cy + r2 * Math.sin(theta));\n      theta += 0.2 * Math.PI;\n    }\n    ctx.closePath();\n    ctx.fillStyle = stroke;\n    ctx.fill();\n    if (stroke && typeof stroke === 'string' && specialColors.includes(stroke)) {\n      this.drawPoints(points);\n    }\n  }\n\n  drawColumn(points: number[][], stroke?: Style) {\n    if (!stroke) return;\n    const { ctx } = this;\n    const [from, to] = points;\n    const r = Math.max(Math.abs(to[0] - from[0]), Math.abs(to[1] - from[1])) / 2;\n    const [cx, cy] = [from[0] + r, from[1] + r];\n    ctx.fillStyle = stroke;\n    ctx.lineWidth = 0.05;\n    ctx.beginPath();\n    ctx.ellipse(cx, cy, r, r, 0, 0, 2 * Math.PI);\n    ctx.fill();\n    if (stroke && typeof stroke === 'string' && specialColors.includes(stroke)) {\n      this.drawPoints(points);\n    }\n  }\n\n  drawStalacmite(points: number[][], fill?: Style, stroke?: Style) {\n    if (!stroke) return;\n    const { ctx } = this;\n    const [from, to] = points;\n    const rng = seedrandom(`(${from[0]},${from[1]}),(${to[0]},${to[1]})`);\n    const r = Math.max(Math.abs(to[0] - from[0]), Math.abs(to[1] - from[1])) / 2;\n    const [cx, cy] = [from[0] + r, from[1] + r];\n    ctx.strokeStyle = stroke;\n    ctx.lineWidth = 0.1;\n    ctx.beginPath();\n    let currRadius = r * Math.max(0.5, rng());\n    let theta = -0.1 * Math.PI;\n    for (let i = 0; i < 20; i++) {\n      if (i === 0) {\n        ctx.moveTo(cx + currRadius * Math.cos(theta), cy + currRadius * Math.sin(theta));\n      } else {\n        ctx.lineTo(cx + currRadius * Math.cos(theta), cy + currRadius * Math.sin(theta));\n      }\n      theta += rng() * 0.2 * Math.PI;\n      if (theta + 0.1 * Math.PI >= 2 * Math.PI) break;\n      if (rng() < 0.5) currRadius += rng() * 0.3;\n      else currRadius -= rng() * 0.3;\n      currRadius = Math.max(0, Math.min(r, currRadius));\n    }\n    ctx.closePath();\n    ctx.stroke();\n    if (fill) {\n      ctx.fillStyle = fill;\n      ctx.fill();\n    }\n    if (stroke && typeof stroke === 'string' && specialColors.includes(stroke)) {\n      this.drawPoints(points);\n    }\n  }\n\n  drawPoints(points: number[][], size: number = 0.25) {\n    const { ctx } = this;\n    ctx.fillStyle = pointColor;\n    ctx.strokeStyle = 'black';\n    ctx.lineWidth = 0.05;\n    for (let i = 0; i < points.length; i++) {\n      ctx.beginPath();\n      ctx.ellipse(points[i][0], points[i][1], size, size, 0, 0, 2 * Math.PI);\n      ctx.fill();\n      ctx.stroke();\n    }\n  }\n\n  pathPoints(points: number[][], close: boolean = false) {\n    const { ctx } = this;\n    ctx.beginPath();\n    ctx.moveTo(points[0][0], points[0][1]);\n    for (let i = 0; i < points.length; i++) {\n      ctx.lineTo(points[i][0], points[i][1]);\n    }\n    if (close) ctx.closePath();\n  }\n\n  pathEllipse(points: number[][], close: boolean = false) {\n    const { ctx } = this;\n    const [a, b] = points;\n    ctx.beginPath();\n    ctx.ellipse(\n      a[0] + (b[0] - a[0]) / 2,\n      a[1] + (b[1] - a[1]) / 2,\n      Math.abs((b[0] - a[0]) / 2),\n      Math.abs((a[1] - b[1]) / 2),\n      0,\n      0,\n      2 * Math.PI);\n    if (close) ctx.closePath();\n  }\n\n  drawFeatures(level: Level, colorIndex: boolean = false) {\n    const featureDrawOrder = ['room', 'other', 'text'];\n    const geometryDrawOrder = ['polygon', 'ellipse', 'line', 'brush', 'door', 'stairs', 'decoration'];\n    featureDrawOrder.forEach(featureType => {\n      geometryDrawOrder.forEach(geometryType => {\n        level.features.forEach((feature, i) => {\n          if (feature.properties.type !== featureType) return;\n          feature.geometries.forEach((geometry, j) => {\n            if (geometry.type !== geometryType) return;\n            if (!geometry.coordinates || geometry.coordinates.length === 0) return;\n            if (colorIndex) {\n              this.drawGeometry(geometry, undefined, undefined, indexToColor(i, j));\n            } else {\n              let areaColor: Style = floorColor;\n              if (geometry.type === 'polygon' && !isCCW(geometry.coordinates)) {\n                areaColor = backgroundColor;\n              }\n              this.drawGeometry(geometry, areaColor, wallColor);\n            }\n          });\n        });\n      });\n    });\n    if (!colorIndex) {\n      level.features.filter(feature => feature.properties.name).forEach((feature, i) => {\n        const c = center(feature);\n        if (!c) return;\n        this.ctx.save();\n        this.ctx.translate(c[0], c[1] - 0.25);\n        this.ctx.fillStyle = '#000';\n        this.renderTextCenter(`${i + 1}`, '0.5px Helvetica');\n        this.ctx.restore();\n      });\n    }\n  }\n\n  drawLevel(level: Level, selectable: boolean) {\n    const { appState } = this;\n    const { width, height } = this.canvas;\n\n    const tmp = this.ctx;\n\n    this.ctx = this.bufferCtx;\n\n    if (selectable) {\n      // color-indexed mouse picking\n      this.ctx.resetTransform();\n      this.ctx.globalCompositeOperation = 'source-over';\n      this.ctx.fillStyle = \"#fff\";\n      this.ctx.fillRect(0, 0, width, height);\n      this.ctx.save();\n      this.ctx.scale(appState.scale, appState.scale);\n      this.ctx.translate(appState.offset[0], appState.offset[1]);\n      this.ctx.scale(this.size, this.size);\n      this.drawFeatures(level, true);\n      if (this.mouse) {\n        const p = this.ctx.getImageData(this.mouse[0], this.mouse[1], 1, 1).data;\n        const [featureIndex, geometryIndex] = colorToIndex(p[0], p[1], p[2]);\n        if (featureIndex === Infinity || featureIndex >= level.features.length || geometryIndex >= level.features[featureIndex].geometries.length) {\n          this.hover = undefined;\n        } else {\n          this.hover = { featureIndex, geometryIndex };\n        }\n      }\n      this.ctx.restore();\n    }\n\n    // setup transform and clear buffer\n    this.ctx.resetTransform();\n    this.ctx.clearRect(0, 0, width, height);\n    this.ctx.save();\n    if (this.mode === 'edit') {\n      this.ctx.scale(appState.scale, appState.scale);\n      this.ctx.translate(appState.offset[0], appState.offset[1]);\n      this.ctx.scale(this.size, this.size);\n    } else {\n      const range = level.features.reduce(([sw, ne], feature) => {\n        return feature.geometries.reduce(([sw, ne], geometry) => {\n          const minX = Math.min(...geometry.coordinates.map(p => p[0]));\n          const maxX = Math.max(...geometry.coordinates.map(p => p[0]));\n          const minY = Math.min(...geometry.coordinates.map(p => p[1]));\n          const maxY = Math.max(...geometry.coordinates.map(p => p[1]));\n          return [\n            [Math.min(sw[0], minX), Math.max(sw[1], maxY)],\n            [Math.max(ne[0], maxX), Math.min(ne[1], minY)],\n          ];\n        }, [sw, ne]);\n      }, [[Infinity, -Infinity], [-Infinity, Infinity]]);\n      const w = range[1][0] - range[0][0];\n      const h = range[0][1] - range[1][1];\n      const extent = Math.max(w, h);\n      const scale = Math.max(this.canvas.width - 20, this.canvas.height - 20) / extent;\n      const levelMid = [range[0][0] + w / 2, range[1][1] + h / 2];\n      this.zoomToCenter([this.canvas.width / 2, this.canvas.height / 2], [levelMid[0], levelMid[1]], scale);\n    }\n\n    this.drawFeatures(level);\n\n    if (selectable && appState.tools.pointer.selected) {\n      if (this.hover !== undefined && this.hover.featureIndex !== undefined) {\n        const hover = level.features[this.hover.featureIndex];\n        if (this.hover.geometryIndex !== undefined && hover !== undefined) {\n          this.drawGeometry(hover.geometries[this.hover.geometryIndex], hoverFillColor, hoverStrokeColor);\n        }\n      }\n      const selection = this.appState.getSelectedFeature();\n      if (selection) {\n        selection.feature.geometries.forEach(geometry => {\n          this.drawGeometry(\n            geometry,\n            geometry === selection.geometry ? selectionFillColor : hoverFillColor,\n            geometry === selection.geometry ? selectionStrokeColor : hoverFillColor);\n        });\n        if (this.drag && dist(this.drag.start, this.drag.end)) {\n          this.ctx.save();\n          const deltaDrag = [this.drag.end[0] - this.drag.start[0], this.drag.end[1] - this.drag.start[1]];\n          this.ctx.translate(deltaDrag[0], deltaDrag[1]);\n          selection.feature.geometries.forEach(geometry => {\n            this.drawGeometry(geometry, dragFillColor, dragStrokeColor);\n          });\n          this.ctx.restore();\n        }\n      }\n    }\n\n    this.ctx.globalCompositeOperation = 'source-over';\n    if (appState.tools.doors.selected && this.mouse) {\n      const door = detectDoorPlacement(\n        this.worldToTile(this.canvasToWorld(this.mouse), false),\n        level.features,\n        this.specialKeys.shift);\n      if (door) {\n        this.drawDoor(appState.tools.doors.subtype, [door.from, door.to], wallColor);\n      }\n    }\n\n    if (this.mode === 'edit') {\n      this.ctx.globalCompositeOperation = 'source-over';\n    } else {\n      this.ctx.globalCompositeOperation = 'source-atop';\n    }\n    this.drawGrid();\n\n    /*\n    const pattern = this.pattern;\n    if (pattern) {\n      pattern.setTransform(this.ctx.getTransform().inverse());\n      this.ctx.globalCompositeOperation = 'source-atop';\n      const range = level.features.reduce(([sw, ne], feature) => {\n        return feature.geometries.reduce(([sw, ne], geometry) => {\n          const minX = Math.min(...geometry.coordinates.map(p => p[0]));\n          const maxX = Math.max(...geometry.coordinates.map(p => p[0]));\n          const minY = Math.min(...geometry.coordinates.map(p => p[1]));\n          const maxY = Math.max(...geometry.coordinates.map(p => p[1]));\n          return [\n            [Math.min(sw[0], minX), Math.max(sw[1], maxY)],\n            [Math.max(ne[0], maxX), Math.min(ne[1], minY)],\n          ];\n        }, [sw, ne]);\n      }, [[Infinity, -Infinity], [-Infinity, Infinity]]);\n      const w = range[1][0] - range[0][0];\n      const h = range[0][1] - range[1][1];\n      this.ctx.fillStyle = pattern;\n      this.ctx.rect(range[0][0] - 1, range[1][1] - 1, w + 2, h + 2);\n      this.ctx.fill();\n      this.ctx.globalCompositeOperation = 'source-over';\n    }\n    */\n\n    this.ctx.restore();\n\n    tmp.drawImage(this.bufferCanvas, 0, 0);\n\n    this.ctx = tmp;\n  }\n\n  render = (time: number) => {\n    if (new Date().getTime() - this.dirty.getTime() < 5000) {\n      const startTime = performance.now();\n      const { ctx, appState } = this;\n      const { tools } = appState;\n      if (this.polygonToolSelected && !appState.tools.polygon.selected) {\n        this.points = [];\n      }\n      this.polygonToolSelected = appState.tools.polygon.selected;\n\n      ctx.resetTransform();\n      this.bufferCtx.resetTransform();\n\n      this.clearScreen();\n\n      // http://jeroenhoek.nl/articles/svg-and-isometric-projection.html\n      // ctx.transform(0.866, 0.5, -0.866, 0.5, 0, 0);\n\n      const map = this.appState.maps[this.appState.selection.mapIndex];\n      const currLevel = this.level !== undefined ? map.levels[this.level] : map.levels[this.appState.selection.levelIndex];\n      this.drawLevel(currLevel, this.mode === 'edit');\n      if (this.mode === 'edit') {\n        ctx.globalAlpha = 0.2;\n        Object.entries(this.appState.selection.ghostLevels).forEach(([levelIndex, ghost]) => {\n          if (ghost) this.drawLevel(map.levels[parseInt(levelIndex)], false);\n        });\n        ctx.globalAlpha = 1;\n      }\n\n      if (this.mode === 'edit') {\n        ctx.save();\n\n        ctx.scale(appState.scale, appState.scale);\n        ctx.translate(appState.offset[0], appState.offset[1]);\n        ctx.scale(this.size, this.size);\n\n        if (this.mouse) {\n          this.drawMousePos(this.mouse);\n        }\n\n        if (this.points.length > 0 && tools.polygon.selected) {\n          this.drawPolygon(this.points, dragFillColor, dragStrokeColor);\n        } else if (this.points.length > 0 && tools.brush.selected) {\n          this.drawBrush(this.points, dragFillColor, dragStrokeColor);\n        } else if (this.drag) {\n          this.drawDrag();\n        }\n      }\n\n      ctx.restore();\n\n      const fps = performance.now() - startTime;\n      this.fps = (fps * 0.1) + this.fps * 0.9;\n      if (appState.debug) {\n        this.renderFPS(time);\n      }\n    }\n    this.requestID = requestAnimationFrame(this.render);\n  }\n}\n\nexport default function Canvas(props: { mode: 'edit' | 'print', level?: number }) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const appState = useContext(Context);\n  const [renderer, setRenderer] = useState<CanvasRenderer | undefined>();\n  useEffect(() => {\n    if (canvasRef.current === null) return;\n    const canvas = canvasRef.current;\n    const renderer: CanvasRenderer = new CanvasRenderer(canvas, props.mode, props.level);\n    const syncSize = () => {\n      canvas.width = canvas.parentElement?.offsetWidth || canvas.width;\n      canvas.height = canvas.parentElement?.offsetHeight || canvas.height;\n      renderer.dirty = new Date();\n    };\n    syncSize();\n    renderer.attachListeners();\n    window.addEventListener('resize', syncSize);\n    renderer.appState = appState;\n    renderer.mode = props.mode;\n    appState.notifyChange = () => {\n      renderer.dirty = new Date();\n    };\n    setRenderer(renderer);\n    return () => {\n      window.removeEventListener('resize', syncSize);\n      renderer.detachListeners();\n    }\n  }, [canvasRef, appState, props.mode, props.level]);\n  return <div style={{ height: \"100%\", width: \"100%\" }}>\n    <canvas ref={canvasRef} style={{ height: \"100%\", width: \"100%\" }} />\n    {props.mode === 'edit' && <Zoom renderer={renderer} />}\n  </div>;\n}\n","import React from 'react';\nimport { css } from 'astroturf';\nimport { sanitize } from 'dompurify';\nimport marked from 'marked';\n\nconst classes = css`\n  .formattedText {\n    margin: 0;\n    padding: 0 8px;\n    color: white;\n  }\n  .formattedText h1 {\n    font-size: 24px;\n    font-family: Helvetica serif;\n    padding: 0 8px;\n    margin: 0;\n    color: white;\n  }\n  .formattedText p {\n    font-size: 18px;\n    font-family: Helvetica serif;\n    padding: 0;\n    margin: 0;\n  }\n`;\n\nexport default function Description(props: { name: string, text: string }) {\n  return <div className={classes.formattedText}>\n    <h1>{props.name}</h1>\n    <div dangerouslySetInnerHTML={{ __html: sanitize(marked(props.text || '')) }} />\n  </div>;\n}","import React from 'react';\nimport { css } from 'astroturf';\nimport classNames from 'classnames';\n\nimport { DS } from './design_system';\nimport Description from './Description';\n\nconst classes = css`\n  .editor {\n    display: flex;\n    flex-direction: column;\n  }\n  .editor textarea {\n    height: 400px;\n    outline: none;\n    border: none;\n  }\n  .name {\n    font-family: Helvetica serif;\n    font-size: 24px;\n    color: white;\n    padding: 8px;\n  }\n  .actions {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin: 12px 24px;\n  }\n`;\n\ninterface Props {\n  name: string\n  description: string\n  onNameChange(name: string): void\n  onDescriptionChange(text: string): void\n  onSave(): void\n  onUndo(): void\n  onDelete?: () => void\n}\n\nexport default function DescriptionEditor(props: Props) {\n  const onNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    props.onNameChange(event.target.value);\n  };\n  const onTextChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    props.onDescriptionChange(event.target.value);\n  };\n  return <div className={classes.editor}>\n    <div style={{ display: 'flex', alignContent: 'center' }}>\n      <input className={DS.input} style={{ flexGrow: 1 }} value={props.name || ''} onChange={onNameChange} />\n    </div>\n    <textarea\n      value={props.description || ''}\n      onChange={onTextChange} />\n    <div className={classes.actions}>\n      {<button className={DS.button} onClick={props.onSave}>Save</button>}\n      {<button className={classNames(DS.button)} onClick={props.onUndo}>Undo</button>}\n      {props.onDelete && <button className={classNames(DS.button, DS.danger)} onClick={props.onDelete}>Delete</button>}\n    </div>\n    <Description name={props.name} text={props.description} />\n  </div>;\n}","import React, { useContext, useState } from 'react';\n\nimport DescriptionEditor from './DescriptionEditor';\nimport { Context } from './State';\n\nexport default function FeatureEditor() {\n  const appState = useContext(Context);\n  const selection = appState.getSelectedFeature();\n  const [lastSelection, setLastSelection] = useState(appState.selection);\n  const [tmpName, setTmpName] = useState<string | undefined>(undefined);\n  const [tmpDescription, setTmpDescription] = useState<string | undefined>(undefined);\n  const onSave = () => {\n    appState.setFeatureDescription({\n      name: tmpName === undefined ? selection?.feature.properties.name : tmpName,\n      description: tmpDescription === undefined ? selection?.feature.properties.description : tmpDescription\n    });\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  };\n  if (appState.selection.levelIndex !== lastSelection.levelIndex || appState.selection.featureIndex !== lastSelection.featureIndex) {\n    setLastSelection(appState.selection);\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  }\n  const onUndo = () => {\n    if (!selection) return;\n    if (selection.feature.properties.name) setTmpName(selection.feature.properties.name);\n    if (selection.feature.properties.description) setTmpDescription(selection.feature.properties.description);\n  };\n  const onDelete = () => {\n    appState.handleDelete();\n  }\n  let name = tmpName || '';\n  if (tmpName === undefined && selection?.feature.properties.name !== undefined) {\n    name = selection?.feature.properties.name;\n  }\n  let description = tmpDescription || '';\n  if (tmpDescription === undefined && selection?.feature.properties.description !== undefined) {\n    description = selection?.feature.properties.description;\n  }\n  return <div>\n    <h3 style={{ color: 'white' }}>Area</h3>\n    <DescriptionEditor\n      name={name}\n      description={description}\n      onNameChange={setTmpName}\n      onDescriptionChange={setTmpDescription}\n      onSave={onSave}\n      onUndo={onUndo}\n      onDelete={onDelete}\n    />\n  </div>;\n}","import React, { CSSProperties, useContext, useState } from 'react';\nimport { css } from 'astroturf';\nimport { DragDropContext, Droppable, Draggable, DropResult } from \"react-beautiful-dnd\";\n\nimport DescriptionEditor from './DescriptionEditor';\nimport { Context } from './State';\n\nconst classes = css`\n  .features {\n    font-family: Helvetica serif;\n    font-size: 18px;\n    color: white;\n    padding: 8px;\n  }\n`;\n\nconst getItemStyle = (isDragging: boolean, isSelected: boolean, draggableStyle: CSSProperties): CSSProperties => ({\n  userSelect: 'none',\n  padding: '4px',\n  margin: '0',\n  background: '#373737',\n  textDecoration: isSelected ? 'underline' : '',\n  ...draggableStyle\n});\n\nconst getListStyle = (isDraggingOver: boolean) => ({\n  background: '#373737',\n  padding: '4px',\n  width: '250px'\n});\n\nexport default function LevelEditor() {\n  const appState = useContext(Context);\n  const level = appState.maps[appState.selection.mapIndex].levels[appState.selection.levelIndex];\n  const [lastSelection, setLastSelection] = useState(appState.selection);\n  const [tmpName, setTmpName] = useState<string | undefined>(undefined);\n  const [tmpDescription, setTmpDescription] = useState<string | undefined>(undefined);\n  const onSave = () => {\n    appState.setLevelDescription({\n      name: tmpName === undefined ? level.name : tmpName,\n      description: tmpDescription === undefined ? level.description : tmpDescription\n    });\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  };\n  if (appState.selection.mapIndex !== lastSelection.mapIndex) {\n    setLastSelection(appState.selection);\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  }\n  const onUndo = () => {\n    setTmpName(level.name);\n    setTmpDescription(level.description);\n  };\n  const namedFeatures = level.features.map((feature, i) => ({ index: i, feature })).filter(f => f.feature.properties.name);\n  const onDragEnd = (result: DropResult) => {\n    if (!result.destination) {\n      return;\n    }\n    appState.setFeatureOrder(\n      namedFeatures[result.source.index].index,\n      namedFeatures[result.destination.index].index);\n  };\n  const onFeatureSelected = (i: number) => () => {\n    appState.setSelection({\n      ...appState.selection,\n      featureIndex: i,\n      geometryIndex: 0,\n    });\n  }\n  let name = tmpName || '';\n  if (tmpName === undefined) name = level.name || '';\n  let description = tmpDescription || '';\n  if (tmpDescription === undefined) description = level.description || '';\n  return <div>\n    <h3 style={{ color: 'white' }}>Level</h3>\n    <DescriptionEditor\n      name={name}\n      description={description}\n      onNameChange={setTmpName}\n      onDescriptionChange={setTmpDescription}\n      onSave={onSave}\n      onUndo={onUndo}\n    />\n    <div className={classes.features}>\n      <DragDropContext onDragEnd={onDragEnd}>\n        <Droppable droppableId=\"droppable\">\n          {(provided, snapshot) => (\n            <div\n              {...provided.droppableProps}\n              ref={provided.innerRef}\n              style={getListStyle(snapshot.isDraggingOver)}\n            >\n              {namedFeatures.map((f, i) => (\n                <Draggable key={i} draggableId={i.toString()} index={i}>\n                  {(provided, snapshot) => (\n                    <div\n                      ref={provided.innerRef}\n                      {...provided.draggableProps}\n                      {...provided.dragHandleProps}\n                      onClick={onFeatureSelected(f.index)}\n                      style={getItemStyle(\n                        snapshot.isDragging,\n                        appState.getSelectedFeature()?.feature === f.feature,\n                        provided.draggableProps.style || {}\n                      )}>\n                      {`${i + 1}. ${f.feature.properties.name}`}\n                    </div>\n                  )}\n                </Draggable>\n              ))}\n              {provided.placeholder}\n            </div>\n          )}\n        </Droppable>\n      </DragDropContext>\n    </div>\n  </div>;\n}","import React, { useContext, useState } from 'react';\n\nimport DescriptionEditor from './DescriptionEditor';\nimport { Context } from './State';\n\nexport default function MapEditor() {\n  const appState = useContext(Context);\n  const map = appState.maps[appState.selection.mapIndex];\n  const [lastSelection, setLastSelection] = useState(appState.selection);\n  const [tmpName, setTmpName] = useState<string | undefined>(undefined);\n  const [tmpDescription, setTmpDescription] = useState<string | undefined>(undefined);\n  const onSave = () => {\n    appState.setMapDescription({\n      name: tmpName === undefined ? map.name : tmpName,\n      description: tmpDescription === undefined ? map.description : tmpDescription\n    });\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  };\n  if (appState.selection.mapIndex !== lastSelection.mapIndex) {\n    setLastSelection(appState.selection);\n    setTmpName(undefined);\n    setTmpDescription(undefined);\n  }\n  const onUndo = () => {\n    setTmpName(map.name);\n    setTmpDescription(map.description);\n  };\n  let name = tmpName || '';\n  if (tmpName === undefined) name = map.name || '';\n  let description = tmpDescription || '';\n  if (tmpDescription === undefined) description = map.description || '';\n  return <div>\n    <h3 style={{ color: 'white' }}>Map</h3>\n    <DescriptionEditor\n      name={name}\n      description={description}\n      onNameChange={setTmpName}\n      onDescriptionChange={setTmpDescription}\n      onSave={onSave}\n      onUndo={onUndo}\n    /></div>;\n}","import React, { useContext, useRef } from 'react';\nimport { css } from 'astroturf';\nimport classNames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCaretLeft, faCaretRight } from '@fortawesome/free-solid-svg-icons';\n\nimport FeatureEditor from './FeatureEditor';\nimport LevelEditor from './LevelEditor';\nimport MapEditor from './MapEditor';\nimport { Context } from './State';\n\nconst classes = css`\n  .drawer {\n    width: 0;\n    margin: 8px 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background: #373737;\n    box-sizing: border-box;\n    transition: .2s ease-out;\n    &.open {\n      transition: .2s ease-out;\n      z-index: 100;\n    }\n  }\n  .toggleButton {\n    position: absolute;\n    top: 0;\n    left: -27px;\n    background: #373737;\n    color: white;\n    outline: none;\n    border: none;\n    font-size: 30px;\n    padding: 8px;\n    border-radius: 4px 0 0 4px;\n  }\n  .editors {\n    height: 97%;\n    overflow: scroll;\n    padding: 8px;\n  }\n`;\n\nexport default function Drawer() {\n  const appState = useContext(Context);\n  const selection = appState.getSelectedFeature();\n  const drawerRef = useRef<HTMLDivElement>(null);\n  const onMouseMove = (e: MouseEvent) => {\n    if (e.buttons !== 1) {\n      document.removeEventListener('mousemove', onMouseMove);\n      return;\n    }\n    if (!drawerRef.current) return;\n    const drag = drawerRef.current.dataset.drag;\n    if (drag) {\n      const width = parseInt(drawerRef.current.style.width.replace('px', ''));\n      drawerRef.current.style.width = `${width + (parseInt(drag) - e.screenX)}px`;\n    }\n    drawerRef.current.dataset.drag = e.screenX.toString();\n  }\n  const onClick = () => {\n    if (!drawerRef.current) return;\n    if (drawerRef.current.dataset.drag) {\n      drawerRef.current.dataset.drag = '';\n      return;\n    }\n    appState.setDrawerOpen(!appState.drawerOpen);\n  }\n  const onMouseDown = (e: React.MouseEvent) => {\n    document.addEventListener('mousemove', onMouseMove);\n    if (!drawerRef.current) return;\n    drawerRef.current.dataset.dragStart = e.screenX.toString();\n  }\n  const onMouseUp = (e: React.MouseEvent) => {\n    document.removeEventListener('mousemove', onMouseMove);\n    if (!drawerRef.current) return;\n    const dragStart = drawerRef.current.dataset.dragStart;\n    if (dragStart) {\n      if (Math.abs(parseInt(dragStart) - e.screenX) < 10) {\n        drawerRef.current.dataset.drag = '';\n      }\n    }\n    const width = parseInt(drawerRef.current.style.width.replace('px', ''));\n    if (width > 100) {\n      appState.setDrawerWidth(width);\n      appState.setDrawerOpen(true);\n    }\n  }\n  return <div\n    ref={drawerRef}\n    className={classNames(classes.drawer, appState.drawerOpen && classes.open)}\n    style={{ width: appState.drawerOpen ? `${appState.drawerWidth}px` : 0 }}>\n    <button\n      className={classNames(classes.toggleButton, appState.drawerOpen && classes.open)}\n      onClick={onClick}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}>\n      {appState.drawerOpen && <FontAwesomeIcon icon={faCaretRight} />}\n      {!appState.drawerOpen && <FontAwesomeIcon icon={faCaretLeft} />}\n    </button>\n    <div className={classes.editors}>\n      <MapEditor />\n      <LevelEditor />\n      {selection && <FeatureEditor />}\n    </div>\n  </div>;\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React, { useContext } from 'react';\nimport { css } from 'astroturf';\nimport {\n  faPlus,\n  faMinus,\n} from '@fortawesome/free-solid-svg-icons'\n\nimport { Context } from './State';\nimport classNames from 'classnames';\n\nconst classes = css`\n  .levels {\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    background: #000;\n    border-radius: 12px;\n    margin-bottom: 50px;\n    margin-left: 24px;\n    padding: 8px;\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\n    color: white;\n  }\n  .levels svg {\n    color: white;\n    font-size: 12px;\n  }\n  .levels button {\n    background: black;\n    width: 24px;\n    height: 24px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n  }\n  .levels button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  .levels button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n  .levels button.selected {\n    color: black;\n    background: #bbb;\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\n  }\n  .levels h4 {\n    margin: 0;\n    padding: 0;\n  }\n  .level {\n    display: flex;\n    align-items: center;\n  }\n  button.link {\n    outline: none;\n    border: none;\n  }\n  .link:hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n`;\n\nexport default function Levels() {\n  const state = useContext(Context);\n  const isGhostLevel = (i: number) => {\n    return state.selection.ghostLevels[i];\n  };\n  const setGhostLevel = (i: number, newValue: boolean) => {\n    state.setSelection({\n      ...state.selection,\n      ghostLevels: {\n        ...state.selection.ghostLevels,\n        [i]: newValue,\n      }\n    });\n  };\n  return <div className={classes.levels}>\n    <h4>Levels</h4>\n    {state.maps[state.selection.mapIndex].levels.map((level, i) => <div key={i} className={classes.level}>\n      <button\n        className={classNames(classes.link, state.selection.levelIndex === i && classes.selected)}\n        onClick={() => state.selectLevel(i)}>\n        {i}\n      </button>\n      <button onClick={() => state.removeLevel(i)}><FontAwesomeIcon icon={faMinus} /></button>\n      <input\n        type=\"checkbox\"\n        checked={isGhostLevel(i)}\n        onChange={e => setGhostLevel(i, e.target.checked)}\n      />\n    </div>)}\n    <button onClick={() => state.addLevel()}><FontAwesomeIcon icon={faPlus} /></button>\n  </div>;\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\nimport { css } from 'astroturf';\nimport {\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons'\n\nconst classes = css`\n  .modal {\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    background-color: rgba(0, 0, 0, 0.4);\n  }\n\n  .modalContent {\n    position: relative;\n    background-color: #373737;\n    color: #fff;\n    margin: 64px auto;\n    padding: 0 20px 20px 20px;\n    border: 1px solid #888;\n    border-radius: 8px;\n    width: 60%;\n  }\n\n  .modalContent button {\n    outline: none;\n    border: none;\n    background-color: transparent;\n    color: #fff;\n    font-size: 24px;\n    position: absolute;\n    top: 8px;\n    right: 8px;\n    text-decoration: none;\n    cursor: pointer;\n  }\n`;\n\nexport default function Modal(props: React.PropsWithChildren<{ open: boolean, toggle: () => void }>) {\n  return <div className={classes.modal} style={{ display: props.open ? 'block' : 'none' }}>\n    <div className={classes.modalContent}>\n      <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n        <button onClick={props.toggle}><FontAwesomeIcon icon={faTimes} /></button>\n      </div>\n      {props.children}\n    </div>\n  </div>;\n}","import React, { useContext, useState } from 'react';\nimport { css } from 'astroturf';\nimport { useHistory } from \"react-router-dom\";\n\nimport Modal from './Modal';\nimport { DS } from './design_system';\nimport { Context } from './State';\n\nconst classes = css`\n  .menubar {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    background: #373737;\n    padding: 2px;\n    width: 100%;\n  }\n  .title {\n    color: white;\n    margin: 8px 24px 8px 24px;\n  }\n  .debugMenu {\n    margin-left: auto;\n    margin-right: 24px;\n  }\n  label {\n    color: white;\n  }\n  .mapLink:hover {\n    text-decoration: underline;\n    cursor: pointer;\n  }\n`;\n\nfunction MapSelector(props: { onSelect: (map: number) => void }) {\n  const appState = useContext(Context);\n  return <div>\n    <h2>Maps</h2>\n    <div>{\n      appState.maps.map((map, i) => <div key={i}>\n        <h4\n          className={classes.mapLink}\n          onClick={() => props.onSelect(i)}>\n          {map.name}\n        </h4>\n      </div>)\n    }</div>\n  </div>\n}\n\nexport default function Menubar() {\n  const appState = useContext(Context);\n  const history = useHistory();\n  const [tmpName, setTmpName] = useState<string | undefined>(undefined);\n  const updateTmpName = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setTmpName(event.target.value);\n  }\n  const name = tmpName === undefined ? appState.maps[appState.selection.mapIndex].name : tmpName;\n  const [showLoadModal, setShowLoadModal] = useState(false);\n  const selectMap = (i: number) => {\n    appState.setSelection({\n      mapIndex: i,\n      levelIndex: 0,\n      featureIndex: undefined,\n      geometryIndex: undefined,\n      ghostLevels: {},\n    });\n    setShowLoadModal(false);\n  }\n  const [lastSelection, setLastSelection] = useState(appState.selection);\n  if (appState.selection.mapIndex !== lastSelection.mapIndex || appState.selection.mapIndex !== lastSelection.mapIndex) {\n    setLastSelection(appState.selection);\n    setTmpName(undefined);\n  }\n  return <React.Fragment>\n    <div className={classes.menubar}>\n      <span className={classes.title}>RPG.ai</span>\n      <input className={DS.input} value={name} onChange={updateTmpName} />\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { appState.save(name || ''); }}>\n        Save\n      </button>\n      {appState.maps.length > 1 && <button\n        className={DS.buttonSmall}\n        onClick={() => { setShowLoadModal(true); }}>\n        Load\n      </button>}\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { appState.newMap(); }}>\n        New\n      </button>\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { appState.undo(); }}>\n        Undo\n      </button>\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { appState.redo(); }}>\n        Redo\n      </button>\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { history.push('/print'); }}>\n        Print\n      </button>\n      <button\n        className={DS.buttonSmall}\n        onClick={() => { appState.toggleWelcome(); }}>\n        Help\n      </button>\n      {appState.debug && <div>\n        <button\n          className={DS.buttonSmall}\n          onClick={() => { appState.export(); }}>\n          Export\n      </button>\n        <button\n          className={DS.buttonSmall}\n          onClick={() => { appState.reset(); }}>\n          Clear\n      </button>\n      </div>}\n      <div className={classes.debugMenu}>\n        <label>Debug</label>\n        <input\n          type=\"checkbox\"\n          checked={appState.debug}\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) => appState.setDebug(event.target.checked)} />\n      </div>\n    </div>\n    {showLoadModal && <Modal open={showLoadModal} toggle={() => setShowLoadModal(!showLoadModal)}>\n      <MapSelector onSelect={selectMap} />\n    </Modal>}\n  </React.Fragment>;\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React, { useContext } from 'react';\nimport { css } from 'astroturf';\nimport {\n  faMapMarkerAlt,\n} from '@fortawesome/free-solid-svg-icons'\n\nimport { Context } from './State';\n\nconst classes = css`\n  .home {\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 8px;\n    z-index: 1;\n  }\n  .home svg {\n    color: #505050;\n    font-size: 24px;\n  }\n  .home button {\n    background: transparent;\n    outline: none;\n    border: none; \n    display: flex;\n    margin: 2px;\n    align-items: center;\n    justify-content: center;\n    width: 24px;\n    height: 24px;\n  }\n  .home button:hover svg {\n    color: #000;\n  }\n`;\n\nexport default function HomeButton() {\n  const state = useContext(Context);\n  return <div className={classes.home}>\n    <button onClick={() => state.setZoom(1, [0, 0])}><FontAwesomeIcon icon={faMapMarkerAlt} /></button>\n  </div>;\n}","import React, { useContext } from 'react';\nimport { css } from 'astroturf';\nimport marked from 'marked';\nimport { sanitize } from 'dompurify';\n\nimport Canvas from './Canvas';\nimport { Context, Level } from './State';\n\nconst classes = css`\n  .print {\n    display: flex;\n    flex-direction: column;\n    font-family: Helvetica serif;\n  }\n  .page {\n    width: 8in;\n    height: 10.5in;\n    display: flex;\n    flex-direction: column;\n    margin-left: auto;\n    margin-right: auto;\n    border-bottom: 1px solid black;\n    padding: 0.25in;\n  }\n  @media print {\n    .page {\n      border-bottom: none !important;\n    }\n  }\n  .pages {\n    width: 8in;\n    display: flex;\n    flex-direction: column;\n    margin-left: auto;\n    margin-right: auto;\n    padding: 0.25in;\n  }\n`;\n\nexport default function PrintLayout() {\n  const appState = useContext(Context);\n  const map = appState.maps[appState.selection.mapIndex];\n  let levels: Level[] = [];\n  map.levels.forEach((level, i) => {\n    levels.push({\n      ...level,\n      features: level.features.filter(feature => feature.properties.name),\n    })\n  });\n  return <div className={classes.print}>\n    <div className={classes.page}>\n      <h2>{map.name}</h2>\n      <div dangerouslySetInnerHTML={{ __html: sanitize(marked(map.description || '')) }} />\n      <div style={{ flexGrow: 1 }}>\n        <Canvas mode=\"print\" level={0} />\n      </div>\n    </div>\n    <div className={classes.pages}>\n      {levels.map((level, i) => <div key={i}>\n        <div style={{ height: '5in' }}>\n          <Canvas mode=\"print\" level={i} />\n        </div>\n        <h2>{level.name}</h2>\n        <div dangerouslySetInnerHTML={{ __html: sanitize(marked(level.description || '')) }} />\n        {level.features.map((feature, j) => <div key={j}>\n          <h3>{`${i + 1}.${j + 1} ${feature.properties.name}`}</h3>\n          <div dangerouslySetInnerHTML={{ __html: sanitize(marked(feature.properties.description || '')) }} />\n        </div>)}\n      </div>)}\n    </div>\n  </div>;\n}","import {\n  IconDefinition,\n  IconLookup,\n  IconName\n} from '@fortawesome/fontawesome-svg-core';\n\nexport const textIcon: IconDefinition & IconLookup = {\n  prefix: 'fab',\n  iconName: 'text' as IconName,\n  icon: [\n    448,\n    512,\n    [],\n    'none',\n    'M432 32a16 16 0 0 1 16 16v96a16 16 0 0 1-16 16h-32a16 16 0 0 1-16-16v-32H264v304h40a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H144a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h40V112H64v32a16 16 0 0 1-16 16H16a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16z'\n  ]\n};\n\nexport const stairsIcon: IconDefinition & IconLookup = {\n  prefix: 'fab',\n  iconName: 'stairs' as IconName,\n  icon: [\n    100,\n    100,\n    [],\n    'none',\n    'M 88.894187,13.349653 H 75.858354 67.310207 v 8.548146 13.036436 H 54.274372 45.726226 v 8.548149 13.035835 H 32.689789 24.141641 v 8.548147 13.035835 H 2.557659 v 8.548146 h 30.13213 V 78.1022 65.066366 H 54.274372 V 56.518219 43.482384 H 75.858354 V 34.934235 21.897799 h 13.035833 8.548154 v -8.548146 z',\n  ]\n};\n\nexport const statueIcon: IconDefinition & IconLookup = {\n  prefix: 'fab',\n  iconName: 'statue' as IconName,\n  icon: [\n    100,\n    100,\n    [],\n    'none',\n    'M 50.000001,0.87620926 C 53.837858,11.917235 57.675715,22.958261 61.513572,33.999287 c 11.686603,0.238155 23.373206,0.47631 35.059809,0.714465 -9.314677,7.061883 -18.629353,14.123767 -27.94403,21.18565 3.38486,11.188214 6.76972,22.376428 10.15458,33.564642 C 69.189287,82.787502 59.594644,76.11096 50,69.434418 40.405356,76.110959 30.810711,82.787501 21.216067,89.464042 24.600928,78.275829 27.985788,67.087615 31.370649,55.899402 22.055973,48.837518 12.741296,41.775633 3.4266201,34.713749 15.113223,34.475595 26.799825,34.237441 38.486428,33.999287 42.324286,22.958261 46.162143,11.917235 50.000001,0.87620926 Z'\n  ]\n}\n\nexport const columnIcon: IconDefinition & IconLookup = {\n  prefix: 'fab',\n  iconName: 'column' as IconName,\n  icon: [\n    100,\n    100,\n    [],\n    'none',\n    'M 99.307838,50.000002 C 99.676865,71.680786 83.863735,92.30908 62.849037,97.645153 43.43672,103.02916 21.169043,95.169716 9.7285742,78.512925 -1.6384271,62.63998 -2.3896164,39.964144 8.336037,23.568937 18.693791,7.0444626 39.349174,-2.2666802 58.573467,1.4133904 77.242915,4.6178118 93.377617,19.344785 97.783979,37.839728 c 1.009833,3.969178 1.527479,8.064294 1.523859,12.160274 z'\n  ]\n}\n\nexport const stalacmiteIcon: IconDefinition & IconLookup = {\n  prefix: 'fab',\n  iconName: 'stalacmite' as IconName,\n  icon: [\n    100,\n    100,\n    [],\n    'none',\n    'm 74.415659,92.321351 c -4.943641,0.08102 -9.841762,-1.089484 -14.790343,-0.658213 -3.565886,-0.471723 -7.22558,0.729371 -9.905688,3.089052 -1.962324,1.335386 -5.447033,1.324308 -6.094083,1.821715 -3.85956,0.399841 -7.750871,0.28678 -11.573283,0.679078 -2.618647,-0.623551 -6.036085,-0.489443 -8.075905,-1.732656 1.155957,-3.724279 4.94719,-5.230686 7.705191,-7.514488 2.969895,-1.745463 3.119779,-6.066341 3.390628,-9.173885 0.977271,-3.506623 0.968227,-6.763139 0.834314,-10.383359 0.215923,-3.830242 -0.1664,-7.549928 0.655209,-11.170453 0.846053,-3.59887 2.294525,-6.963584 3.511139,-10.460921 0.866289,-3.295106 0.609567,-7.081046 1.683639,-10.061072 1.42479,-3.266581 3.711094,-6.049776 5.124971,-9.287309 1.837583,-3.091687 3.916701,-6.009869 3.773832,-9.893974 0.571828,-4.55039 1.017447,-9.2261117 1.445585,-13.7209267 3.030585,-2.95287215 6.303553,0.1796971 8.022745,2.5391129 3.780486,-0.6640017 2.841131,5.3726878 4.064949,7.7612308 0.861812,3.528943 1.440482,7.099871 1.327164,10.73674 -0.02487,3.466809 0.535472,6.773821 1.338634,10.143058 1.921669,3.216066 -0.39964,6.716109 0.466581,10.116214 -0.08226,4.045679 1.089512,8.062286 2.357768,11.873417 3.207109,1.44481 4.605866,4.867853 4.700711,8.604547 -0.214383,4.020444 0.705194,8.095625 -0.21518,12.020218 -0.141146,3.376494 0.09043,6.94965 1.137373,9.996727 1.650808,1.264756 0.198735,3.557255 -0.885951,4.676147 z',\n  ]\n}","import React from 'react';\nimport { css } from 'astroturf';\nimport { faCaretLeft, faDoorClosed, faSquare, faVectorSquare } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { statueIcon } from './icons/custom_icons';\n\nconst classes = css`\n  .welcomePage {\n    display: flex;\n    flex-direction: column;\n  }\n  .welcomePage a {\n    color: white;\n  }\n  .welcomePage li {\n    padding: 4px;\n  }\n  .footer {\n    font-size: 16px;\n    margin-left: auto;\n    margin-right: auto;\n  }\n`;\n\nexport default function Welcome() {\n  return <div className={classes.welcomePage}>\n    <h2>Welcome to the RPG.ai Mapmaker</h2>\n    <h3>Quick Start</h3>\n    <ul>\n      <li>Use the scroll wheel or hold space to scroll around</li>\n      <li>Select the Wall tool (<FontAwesomeIcon icon={faSquare} />) to build walls</li>\n      <li>Select the Rect tool (<FontAwesomeIcon icon={faVectorSquare} />) for rectangular areas</li>\n      <li>Place Decorations (<FontAwesomeIcon icon={statueIcon} />) and Doors (<FontAwesomeIcon icon={faDoorClosed} />) </li>\n      <li>Select and Annotate your areas (checkout the Drawer <FontAwesomeIcon icon={faCaretLeft} /> on the right)</li>\n      <li>Click \"Print\" and print your map as a PDF</li>\n    </ul>\n    <h3>Support</h3>\n    <ul>\n      <li>File bugs at <a href=\"https://github.com/etherealmachine/mapmaker/issues\">Github Issues</a></li>\n      <li>If you like the project, or want more features, support development on <a href=\"https://www.patreon.com/etherealmachine\">Patreon</a></li>\n    </ul>\n    <p className={classes.footer}>Developed by <a href=\"https://github.com/etherealmachine\">@etherealmachine</a>, Copyright 2020</p>\n  </div>;\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { createPopper } from '@popperjs/core';\nimport { css } from 'astroturf';\n\nconst classes = css`\n  .tooltip {\n    color: white;\n    background: black;\n    border-radius: 4px;\n    padding: 8px;\n  }\n`;\n\nexport default function Tooltip(props: React.PropsWithChildren<{ tooltip: string }>) {\n  const parentRef = useRef<HTMLDivElement>(null);\n  const hoverRef = useRef<HTMLDivElement>(null);\n  const tooltipRef = useRef<HTMLSpanElement>(null);\n  const [shown, setShown] = useState(false);\n  const show = () => {\n    setShown(true);\n  };\n  const hide = () => {\n    setShown(false);\n  }\n  useEffect(() => {\n    if (parentRef.current && tooltipRef.current) {\n      createPopper(parentRef.current, tooltipRef.current, {\n        placement: 'right',\n        modifiers: [\n          {\n            name: 'offset',\n            options: {\n              offset: [0, 20],\n            },\n          },\n        ],\n      });\n    }\n    if (hoverRef.current) {\n      hoverRef.current.addEventListener('mouseenter', show);\n      hoverRef.current.addEventListener('mouseleave', hide);\n    }\n  }, [parentRef, tooltipRef]);\n  return <div ref={parentRef}>\n    <span\n      ref={tooltipRef}\n      style={shown ? {} : { visibility: 'hidden' }}\n      className={classes.tooltip}>\n      {props.tooltip}\n    </span>\n    <div ref={hoverRef}>\n      {props.children}\n    </div>\n  </div>;\n}","import React from 'react';\nimport { css } from 'astroturf';\n\nconst classes = css`\n  .toggle {\n    position: relative;\n    display: inline-block;\n    width: 100%;\n    height: 34px;\n  }\n\n  .toggle input {\n    opacity: 0;\n    width: 0;\n    height: 0;\n  }\n\n  .slider {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 34px;\n  }\n\n  .slider:before {\n    position: absolute;\n    content: \"\";\n    height: 26px;\n    width: 26px;\n    left: 4px;\n    bottom: 4px;\n    background-color: white;\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 50%;\n  }\n\n  .toggle input:checked + .slider {\n    background-color: #2196F3;\n  }\n\n  .toggle input:focus + .slider {\n    box-shadow: 0 0 1px #2196F3;\n  }\n\n  .toggle input:checked + .slider:before {\n    -webkit-transform: translateX(26px);\n    -ms-transform: translateX(26px);\n    transform: translateX(26px);\n  }\n`;\n\nexport default function Toggle(props: { toggled: boolean, onToggle: () => void }) {\n  return <label className={classes.toggle}>\n    <input type=\"checkbox\" checked={props.toggled} onChange={props.onToggle} />\n    <span className={classes.slider}></span>\n  </label>;\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React, { useContext } from 'react';\nimport {\n  faMousePointer,\n  faVectorSquare,\n  faDrawPolygon,\n  IconDefinition,\n  faDoorClosed,\n  faSquare,\n  faBrush,\n  faStrikethrough,\n  faExclamationTriangle,\n} from '@fortawesome/free-solid-svg-icons'\n\nimport { DS } from './design_system';\nimport { Context, ToolName } from './State';\nimport Tooltip from './Tooltip';\nimport Toggle from './Toggle';\nimport { columnIcon, stairsIcon, stalacmiteIcon, statueIcon } from './icons/custom_icons';\nimport { faCircle } from '@fortawesome/free-regular-svg-icons';\n\ninterface Button {\n  icon?: IconDefinition\n  tooltip: string,\n  options?: { [key: string]: Button }\n}\n\nconst buttons: { [key in ToolName]: Button } = {\n  'pointer': { icon: faMousePointer, tooltip: 'Select' },\n  'walls': { icon: faSquare, tooltip: 'Walls' },\n  'stairs': { icon: stairsIcon, tooltip: 'Stairs' },\n  'doors': {\n    tooltip: 'Doors', options: {\n      'normal': { icon: faDoorClosed, tooltip: 'Normal Door' },\n      'secret': { icon: faStrikethrough, tooltip: 'Secret Door' },\n    }\n  },\n  'decoration': {\n    tooltip: 'Decorations', options: {\n      'statue': { icon: statueIcon, tooltip: 'Statue' },\n      'column': { icon: columnIcon, tooltip: 'Column' },\n      'stalacmite': { icon: stalacmiteIcon, tooltip: 'Stalacmite' },\n    }\n  },\n  'brush': { icon: faBrush, tooltip: 'Paint' },\n  'rect': { icon: faVectorSquare, tooltip: 'Rectangle' },\n  'polygon': { icon: faDrawPolygon, tooltip: 'Polygon' },\n  'ellipse': { icon: faCircle, tooltip: 'Circle/Ellipse' },\n};\n\nexport default function Toolbar() {\n  const state = useContext(Context);\n  const handleButtonClick = (tool: ToolName) => () => {\n    state.setSelectedTool(tool);\n  };\n  const toggleGridSteps = () => {\n    state.setGridSteps(state.gridSteps === 1 ? 2 : 1);\n  };\n  const isOptionSelected = (tool: ToolName, option: string) => {\n    if (state.tools[tool].hasOwnProperty('subtype')) {\n      return (state.tools[tool] as any).subtype === option;\n    }\n    return false;\n  };\n  const handleOptionClick = (tool: ToolName, option: string) => () => {\n    state.setToolOption(tool, option);\n  };\n  const iconFor = (tool: ToolName) => {\n    const button = buttons[tool];\n    if (button?.options) return button.options[(state.tools[tool] as any).subtype].icon || faExclamationTriangle;\n    return button?.icon || faExclamationTriangle;\n  }\n  return <div className={DS.toolbar} style={{ position: 'absolute', top: '50px', left: '24px' }}>\n    {Object.entries(state.tools).map(([name, spec]) => <Tooltip key={name} tooltip={buttons[name as ToolName]?.tooltip}>\n      <React.Fragment>\n        <button\n          className={spec.selected ? DS.selected : ''}\n          disabled={spec.disabled}\n          onClick={handleButtonClick(name as ToolName)}>\n          <FontAwesomeIcon icon={iconFor(name as ToolName)} />\n        </button>\n        {spec.selected && buttons[name as ToolName].options && <div className={DS.toolbar}>\n          {Object.entries(buttons[name as ToolName].options || {}).map(([optionName, optionSpec]) => <Tooltip key={optionName} tooltip={optionSpec.tooltip}>\n            <button className={isOptionSelected(name as ToolName, optionName) ? DS.selected : ''}\n              onClick={handleOptionClick(name as ToolName, optionName)}>\n              <FontAwesomeIcon icon={optionSpec.icon || faExclamationTriangle} />\n            </button>\n          </Tooltip>)}\n        </div>}\n      </React.Fragment>\n    </Tooltip>)}\n    <Toggle toggled={state.gridSteps === 2} onToggle={toggleGridSteps} />\n  </div>;\n}","import { Dispatch, SetStateAction, useState } from \"react\";\n\nfunction isObject(i: any) {\n  return (i && typeof i === 'object' && !Array.isArray(i));\n}\n\nfunction inflate(target: any, ...objs: any[]): any {\n  if (!objs.length) return target;\n  const obj = objs.shift();\n  if (isObject(target) && isObject(obj)) {\n    for (const key in obj) {\n      if (isObject(obj[key])) {\n        if (!target[key]) Object.assign(target, { [key]: {} });\n        inflate(target[key], obj[key]);\n      } else {\n        if (Object.isFrozen(target)) {\n          target = unfreeze(target);\n        }\n        Object.assign(target, { [key]: obj[key] });\n      }\n    }\n  }\n  return inflate(target, ...objs);\n}\n\nfunction unfreeze(o: any) {\n  let oo: any = undefined;\n  if (o instanceof Array) {\n    oo = []; const clone = (v: any) => { oo.push(v) };\n    o.forEach(clone);\n  } else if (o instanceof String) {\n    oo = o;\n  } else if (typeof o == 'object') {\n    oo = {};\n    for (var property in o) { oo[property] = o[property]; }\n  }\n  return oo;\n}\n\nexport function useLocalStorageState<T>(key: string, initial: T): [T, Dispatch<SetStateAction<T>>] {\n  const fromLocalStorage = window.localStorage.getItem(key);\n  if (fromLocalStorage !== null) inflate(initial, JSON.parse(fromLocalStorage));\n  const [state, setState] = useState<T>(initial);\n  return [state, (newState: any) => {\n    window.localStorage.setItem(key, JSON.stringify(newState));\n    setState(newState);\n  }];\n}","/*\n  RPG.ai brings Table Top Role Playing Games to the next level\n\n  RPG.ai lets you easily draw beautiful maps full of NPCs, object, and areas for players to explore.\n*/\nimport React, { useState } from 'react';\nimport { css } from 'astroturf';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\nimport Canvas from './Canvas';\nimport Drawer from './Drawer';\nimport LevelSelector from './LevelSelector';\nimport Menubar from './Menubar';\nimport Modal from './Modal';\nimport HomeButton from './HomeButton';\nimport PrintLayout from './PrintLayout';\nimport Welcome from './Welcome';\nimport Toolbar from './Toolbar';\nimport { Context, State } from './State';\nimport { useLocalStorageState } from './Persistence';\n\nconst classes = css`\n  .app {\n    width: 100vw;\n    height: 100vh;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n  }\n  .canvasWrapper {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n  }\n`;\n\nexport default function App() {\n  const [i, setCount] = useState(0);\n  const [state, setState] = useLocalStorageState('AppState', new State());\n  state.setState = (newState: State) => {\n    setState(newState);\n    setCount(i + 1);\n  };\n  (window as any).app = state;\n  document.title = state.maps[state.selection.mapIndex].name || 'RPG.ai';\n  return <Router>\n    <Switch>\n      <Route path=\"/print\">\n        <div className={classes.app}>\n          <Context.Provider value={state}>\n            <PrintLayout />\n          </Context.Provider>\n        </div>\n      </Route>\n      <Route path=\"/\">\n        <div className={classes.app} style={{ overflow: 'hidden' }}>\n          <Context.Provider value={state}>\n            <Menubar />\n            <div className={classes.canvasWrapper}>\n              <Modal open={state.showWelcome} toggle={state.toggleWelcome.bind(state)}><Welcome /></Modal>\n              <Canvas mode='edit' />\n              <Drawer />\n              <Toolbar />\n              <LevelSelector />\n              <HomeButton />\n            </div>\n          </Context.Provider>\n        </div>\n      </Route>\n    </Switch>\n  </Router>;\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from \"@sentry/react\";\nimport { Integrations } from \"@sentry/tracing\";\n\nimport './index.css';\nimport App from './App';\n\nSentry.init({\n  dsn: \"https://d42a7c4cafcb47f5b298dbf6e44b1834@o486991.ingest.sentry.io/5545134\",\n  integrations: [\n    new Integrations.BrowserTracing(),\n  ],\n  tracesSampleRate: 1.0,\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}